<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Extended Morphology Models • apb2019</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Extended Morphology Models">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">apb2019</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/RB_Discrete_Morphology/RB_MCMC_Discrete_Morph.html">Discrete morphology - Tree Inference</a>
    </li>
    <li>
      <a href="../../articles/RB_Total_Evidence/RB_Total_Evidence_Tutorial.html">RevBayes Total Evidence Tree Estimation</a>
    </li>
    <li>
      <a href="../../articles/R_exercises/00-installs.html">Installs</a>
    </li>
    <li>
      <a href="../../articles/R_exercises/01-treesiftr.html">treesifter GUI</a>
    </li>
    <li>
      <a href="../../articles/R_exercises/02-treesiftr-advanced.html">treesifter advanced</a>
    </li>
    <li>
      <a href="../../articles/R_exercises/03-FossilSim.html">FossilSim FBD Exercise</a>
    </li>
    <li>
      <a href="../../articles/lectures/BayesianModels.html">Bayesian Models</a>
    </li>
    <li>
      <a href="../../articles/lectures/CompMethods.html">Extended Morphology Models</a>
    </li>
    <li>
      <a href="../../articles/lectures/TreeThinking.html">Tree Thinking</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Extended Morphology Models</h1>
                        <h4 class="author">April Wright</h4>
            
            <h4 class="date">7.18.19</h4>
      
      
      <div class="hidden name"><code>CompMethods.Rmd</code></div>

    </div>

    
    
<div id="so-what-are-you-going-to-do-with-your-tree" class="section level2">
<h2 class="hasAnchor">
<a href="#so-what-are-you-going-to-do-with-your-tree" class="anchor"></a>So what are you going to do with your tree?</h2>
</div>
<div id="using-trees-to-understand-trait-evolution" class="section level2">
<h2 class="hasAnchor">
<a href="#using-trees-to-understand-trait-evolution" class="anchor"></a>Using trees to understand trait evolution</h2>
<ul>
<li>What is a phylogeny?
<ul>
<li>A model of evolutionary history<br>
</li>
<li>Speciation and extinction<br>
</li>
<li>Rates of evolution<br>
</li>
<li>(Maybe) absolute time</li>
</ul>
</li>
</ul>
</div>
<div id="using-trees-to-understand-trait-evolution-1" class="section level2">
<h2 class="hasAnchor">
<a href="#using-trees-to-understand-trait-evolution-1" class="anchor"></a>Using trees to understand trait evolution</h2>
<ul>
<li>But there are also special challenges to using phylogenetic trees to study the evolutionary history of traits</li>
</ul>
</div>
<div id="linear-regression" class="section level2">
<h2 class="hasAnchor">
<a href="#linear-regression" class="anchor"></a>Linear Regression</h2>
<p>Let’s say that in your group of organisms, you believe that arboreality is associated with lower visual acuity.</p>
</div>
<div id="linear-regression-1" class="section level2">
<h2 class="hasAnchor">
<a href="#linear-regression-1" class="anchor"></a>Linear Regression</h2>
<p>Let’s say that in your group of organisms, you believe that arboreality is associated with lower visual acuity.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>arboreality &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(.<span class="dv">1</span>, <span class="fl">.2</span>, <span class="fl">.3</span>, <span class="fl">.4</span>, <span class="fl">.5</span>, <span class="fl">.6</span>, <span class="fl">.7</span>, <span class="fl">.8</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>vis_ac &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="fl">.8</span>, <span class="fl">.6</span>, <span class="fl">.4</span>, <span class="fl">.35</span>, <span class="fl">.3</span>, <span class="fl">.25</span>, <span class="fl">.2</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(arboreality, vis_ac)</span></code></pre></div>
<p><img src="CompMethods_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
</div>
<div id="linear-regression-2" class="section level2">
<h2 class="hasAnchor">
<a href="#linear-regression-2" class="anchor"></a>Linear Regression</h2>
<p>What is wrong with what we have done?</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>arboreality &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(.<span class="dv">1</span>, <span class="fl">.2</span>, <span class="fl">.3</span>, <span class="fl">.4</span>, <span class="fl">.5</span>, <span class="fl">.6</span>, <span class="fl">.7</span>, <span class="fl">.8</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a>vis_ac &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="fl">.8</span>, <span class="fl">.6</span>, <span class="fl">.4</span>, <span class="fl">.35</span>, <span class="fl">.3</span>, <span class="fl">.25</span>, <span class="fl">.2</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(arboreality, vis_ac)</span></code></pre></div>
<p><img src="CompMethods_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
</div>
<div id="linear-regression-3" class="section level2">
<h2 class="hasAnchor">
<a href="#linear-regression-3" class="anchor"></a>Linear Regression</h2>
<p>What is wrong with what we have done?</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>arboreality &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(.<span class="dv">1</span>, <span class="fl">.2</span>, <span class="fl">.3</span>, <span class="fl">.4</span>, <span class="fl">.5</span>, <span class="fl">.6</span>, <span class="fl">.7</span>, <span class="fl">.8</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>vis_ac &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="fl">.8</span>, <span class="fl">.6</span>, <span class="fl">.4</span>, <span class="fl">.35</span>, <span class="fl">.3</span>, <span class="fl">.25</span>, <span class="fl">.2</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(arboreality, vis_ac)</span></code></pre></div>
<p><img src="CompMethods_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>These are not independent datapoints!</p>
</div>
<div id="linear-regression-4" class="section level2">
<h2 class="hasAnchor">
<a href="#linear-regression-4" class="anchor"></a>Linear Regression</h2>
<p>What is the problem with what we’ve done?</p>
<div class="figure">
<img src="img/fels1.png" alt=""><p class="caption">Felsenstein Phylogenies and the Comparative Method, 1985</p>
</div>
<p>These are not independent datapoints!</p>
</div>
<div id="linear-regression-5" class="section level2">
<h2 class="hasAnchor">
<a href="#linear-regression-5" class="anchor"></a>Linear Regression</h2>
<p>Does this mean we simply can’t make these comparsions?</p>
</div>
<div id="linear-regression-6" class="section level2">
<h2 class="hasAnchor">
<a href="#linear-regression-6" class="anchor"></a>Linear Regression</h2>
<p>Does this mean we simply can’t make these comparsions?</p>
<p>No! But we <em>must</em> account for the effect of shared heritage.</p>
</div>
<div id="brownian-motion" class="section level2">
<h2 class="hasAnchor">
<a href="#brownian-motion" class="anchor"></a>Brownian Motion</h2>
<ul>
<li><p>Based on the random movement of particles in fluid</p></li>
<li><p>The idea is that sucessive movements are independent of each other.</p></li>
</ul>
</div>
<div id="brownian-motion-1" class="section level2">
<h2 class="hasAnchor">
<a href="#brownian-motion-1" class="anchor"></a>Brownian Motion</h2>
<ul>
<li><p>Under this model, traits evolve due to a continuous random walk.</p></li>
<li><p>The difference (contrast) between the traits possessed by any two tips on the tree will be normally distributed. The mean of the normal will be 0, and the variance will be proportional to the time since common ancestor.</p></li>
</ul>
</div>
<div id="brownian-motion-2" class="section level2">
<h2 class="hasAnchor">
<a href="#brownian-motion-2" class="anchor"></a>Brownian Motion</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dt">length=</span><span class="dv">100</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a>norms &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">dnorm</a></span>(x, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(norms)</span></code></pre></div>
<p><img src="CompMethods_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div id="brownian-motion-3" class="section level2">
<h2 class="hasAnchor">
<a href="#brownian-motion-3" class="anchor"></a>Brownian Motion</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>steps &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">50</span>  </span>
<span id="cb5-2"><a href="#cb5-2"></a>var &lt;-<span class="st"> </span><span class="fl">0.01</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dt">n =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(steps) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">sd =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">sqrt</a></span>(var))</span>
<span id="cb5-4"><a href="#cb5-4"></a>x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cumsum">cumsum</a></span>(x))</span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(steps, x, <span class="dt">type =</span> <span class="st">"line"</span>)</span></code></pre></div>
<pre><code>## Warning in plot.xy(xy, type, ...): plot type 'line' will be truncated to
## first character</code></pre>
<p><img src="CompMethods_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div id="brownian-motion-4" class="section level2">
<h2 class="hasAnchor">
<a href="#brownian-motion-4" class="anchor"></a>Brownian Motion</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>steps &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">50</span>  </span>
<span id="cb7-2"><a href="#cb7-2"></a>var &lt;-<span class="st"> </span><span class="fl">0.01</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>n_sims &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>sim_mat &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="dv">0</span>, n_sims, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(steps))</span>
<span id="cb7-5"><a href="#cb7-5"></a></span>
<span id="cb7-6"><a href="#cb7-6"></a></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n_sims) {</span>
<span id="cb7-8"><a href="#cb7-8"></a>  sim_mat[i, ] &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cumsum">cumsum</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dt">n =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(steps) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">sd =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">sqrt</a></span>(var))))</span>
<span id="cb7-9"><a href="#cb7-9"></a>}</span>
<span id="cb7-10"><a href="#cb7-10"></a></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(steps, sim_mat[<span class="dv">1</span>, ], <span class="dt">type =</span> <span class="st">"line"</span>, <span class="dt">ylim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>, <span class="dv">-2</span>)) <span class="co">#when you scale var, you may need to adjust the axis!</span></span></code></pre></div>
<pre><code>## Warning in plot.xy(xy, type, ...): plot type 'line' will be truncated to
## first character</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n_sims) {</span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(steps, sim_mat[i, ])</span>
<span id="cb9-3"><a href="#cb9-3"></a>}</span></code></pre></div>
<p><img src="CompMethods_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div id="phylogenetically-independent-contrasts" class="section level2">
<h2 class="hasAnchor">
<a href="#phylogenetically-independent-contrasts" class="anchor"></a>Phylogenetically Independent Contrasts</h2>
<p><img src="img/fels3.png"></p>
<p>1, 2, 3, 4 are not independent. But the difference between 1 &amp; 2 is independent of the difference between 3 &amp; 4.</p>
</div>
<div id="phylogenetically-independent-contrasts-1" class="section level2">
<h2 class="hasAnchor">
<a href="#phylogenetically-independent-contrasts-1" class="anchor"></a>Phylogenetically Independent Contrasts</h2>
<p><img src="img/fels4.png"></p>
<p>Contrasts usually standardized by the variance</p>
</div>
<div id="brownian-motion-on-a-tree" class="section level2">
<h2 class="hasAnchor">
<a href="#brownian-motion-on-a-tree" class="anchor"></a>Brownian Motion on a Tree</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(phytools)</span></code></pre></div>
<pre><code>## Loading required package: ape</code></pre>
<pre><code>## Loading required package: maps</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>tree &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/phytools/topics/pbtree">pbtree</a></span>(<span class="dt">n=</span><span class="dv">20</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a>x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/phytools/topics/fastBM">fastBM</a></span>(tree, <span class="dt">sig2 =</span> var, <span class="dt">internal =</span> <span class="ot">TRUE</span>)</span>
<span id="cb13-3"><a href="#cb13-3"></a>x</span></code></pre></div>
<pre><code>##          t17          t18           t3           t4          t11 
## -0.264792459 -0.173781946 -0.413265655 -0.207943395 -0.253240480 
##          t12           t1           t2           t5           t6 
## -0.360026077 -0.216532009  0.025894595  0.130650957 -0.008919495 
##           t8          t19          t20          t15          t16 
## -0.139843222 -0.101329888 -0.078297988 -0.159640098 -0.196444611 
##           t7           t9          t10          t13          t14 
##  0.069387578  0.070220856  0.089750098  0.006900901 -0.028488026 
##           21           22           23           24           25 
##  0.000000000 -0.038575992 -0.094382514 -0.148173796 -0.229004410 
##           26           27           28           29           30 
## -0.275277294 -0.292753971 -0.261647848 -0.072709904 -0.078814242 
##           31           32           33           34           35 
## -0.045169370 -0.107796191 -0.145221692 -0.107492762 -0.186954201 
##           36           37           38           39 
##  0.058164202  0.037419156  0.036045086  0.002497652</code></pre>
</div>
<div id="brownian-motion-on-a-tree-1" class="section level2">
<h2 class="hasAnchor">
<a href="#brownian-motion-on-a-tree-1" class="anchor"></a>Brownian Motion on a Tree</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>tree &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/phytools/topics/pbtree">pbtree</a></span>(<span class="dt">n=</span><span class="dv">20</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a>x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/phytools/topics/fastBM">fastBM</a></span>(tree, <span class="dt">sig2 =</span> var, <span class="dt">internal =</span> <span class="ot">TRUE</span>)</span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/phytools/topics/phenogram">phenogram</a></span>(tree, x)</span></code></pre></div>
<p><img src="CompMethods_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div id="brownian-motion-on-a-tree-2" class="section level2">
<h2 class="hasAnchor">
<a href="#brownian-motion-on-a-tree-2" class="anchor"></a>Brownian Motion on a Tree</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/phytools/topics/fastBM">fastBM</a></span>(tree, <span class="dt">sig2 =</span> var, <span class="dt">internal =</span> <span class="ot">FALSE</span>)</span>
<span id="cb16-2"><a href="#cb16-2"></a>contrasts &lt;-<span class="st"> </span><span class="kw">pic</span>(x, tree, <span class="dt">scaled=</span><span class="ot">FALSE</span>)</span>
<span id="cb16-3"><a href="#cb16-3"></a>contrasts</span></code></pre></div>
<pre><code>##           21           22           23           24           25 
## -0.527833858 -0.181408083 -0.066054913 -0.027386182  0.107757008 
##           26           27           28           29           30 
## -0.073053338  0.068870061  0.123975861 -0.035974215 -0.086696879 
##           31           32           33           34           35 
## -0.012884844  0.003306994 -0.034941284  0.105577509 -0.038794335 
##           36           37           38           39 
## -0.063180163 -0.016952661  0.007659031 -0.053301550</code></pre>
</div>
<div id="brownian-motion-on-a-tree-3" class="section level2">
<h2 class="hasAnchor">
<a href="#brownian-motion-on-a-tree-3" class="anchor"></a>Brownian Motion on a Tree</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(tree)</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="kw">nodelabels</span>(contrasts)</span></code></pre></div>
<p><img src="CompMethods_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div id="brownian-motion-on-a-tree-4" class="section level2">
<h2 class="hasAnchor">
<a href="#brownian-motion-on-a-tree-4" class="anchor"></a>Brownian Motion on a Tree</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>important_environmental_factor &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">19</span>, <span class="dt">by =</span> <span class="dv">1</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(contrasts, important_environmental_factor)</span></code></pre></div>
<p><img src="CompMethods_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div id="two-implications" class="section level2">
<h2 class="hasAnchor">
<a href="#two-implications" class="anchor"></a>Two Implications</h2>
<ul>
<li>Ancestral state estimation</li>
<li>Models, and model assumptions</li>
</ul>
</div>
<div id="ancestral-state-reconstruction" class="section level2">
<h2 class="hasAnchor">
<a href="#ancestral-state-reconstruction" class="anchor"></a>Ancestral State Reconstruction</h2>
<p>Phylogenetic independent contrasts assume we can estimate the value of the trait possessed by an ancestor through Brownian motion</p>
</div>
<div id="ancestral-state-reconstruction-1" class="section level2">
<h2 class="hasAnchor">
<a href="#ancestral-state-reconstruction-1" class="anchor"></a>Ancestral State Reconstruction</h2>
<ul>
<li>But we’ve already seen ancestral state estimation
<ul>
<li>Recall the AND/OR rule discussions from day one<br>
</li>
<li>Conditional probabilities - What is the likelihood of a state at the tips given the state at the nodes<br>
</li>
<li>Ancestral state reconstruction allows us to apply this logic to external traits</li>
</ul>
</li>
</ul>
</div>
<div id="ancestral-state-reconstruction-2" class="section level2">
<h2 class="hasAnchor">
<a href="#ancestral-state-reconstruction-2" class="anchor"></a>Ancestral State Reconstruction</h2>
<ul>
<li>Ancestral state reconstruction can vary in its complexity
<ul>
<li>The first applications came from parsimony (Swofford and Maddison 1987)</li>
</ul>
</li>
</ul>
</div>
<div id="ancestral-state-reconstruction-3" class="section level2">
<h2 class="hasAnchor">
<a href="#ancestral-state-reconstruction-3" class="anchor"></a>Ancestral State Reconstruction</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(phangorn)</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(phytools)</span>
<span id="cb20-3"><a href="#cb20-3"></a>tree_<span class="dv">20</span> &lt;-<span class="st"> </span>phytools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/phytools/topics/pbtree">pbtree</a></span>(<span class="dt">n=</span><span class="dv">20</span>)</span>
<span id="cb20-4"><a href="#cb20-4"></a>trait &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/phytools/topics/fastBM">fastBM</a></span>(tree_<span class="dv">20</span>)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#so-what-are-you-going-to-do-with-your-tree">So what are you going to do with your tree?</a></li>
      <li><a href="#using-trees-to-understand-trait-evolution">Using trees to understand trait evolution</a></li>
      <li><a href="#using-trees-to-understand-trait-evolution-1">Using trees to understand trait evolution</a></li>
      <li><a href="#linear-regression">Linear Regression</a></li>
      <li><a href="#linear-regression-1">Linear Regression</a></li>
      <li><a href="#linear-regression-2">Linear Regression</a></li>
      <li><a href="#linear-regression-3">Linear Regression</a></li>
      <li><a href="#linear-regression-4">Linear Regression</a></li>
      <li><a href="#linear-regression-5">Linear Regression</a></li>
      <li><a href="#linear-regression-6">Linear Regression</a></li>
      <li><a href="#brownian-motion">Brownian Motion</a></li>
      <li><a href="#brownian-motion-1">Brownian Motion</a></li>
      <li><a href="#brownian-motion-2">Brownian Motion</a></li>
      <li><a href="#brownian-motion-3">Brownian Motion</a></li>
      <li><a href="#brownian-motion-4">Brownian Motion</a></li>
      <li><a href="#phylogenetically-independent-contrasts">Phylogenetically Independent Contrasts</a></li>
      <li><a href="#phylogenetically-independent-contrasts-1">Phylogenetically Independent Contrasts</a></li>
      <li><a href="#brownian-motion-on-a-tree">Brownian Motion on a Tree</a></li>
      <li><a href="#brownian-motion-on-a-tree-1">Brownian Motion on a Tree</a></li>
      <li><a href="#brownian-motion-on-a-tree-2">Brownian Motion on a Tree</a></li>
      <li><a href="#brownian-motion-on-a-tree-3">Brownian Motion on a Tree</a></li>
      <li><a href="#brownian-motion-on-a-tree-4">Brownian Motion on a Tree</a></li>
      <li><a href="#two-implications">Two Implications</a></li>
      <li><a href="#ancestral-state-reconstruction">Ancestral State Reconstruction</a></li>
      <li><a href="#ancestral-state-reconstruction-1">Ancestral State Reconstruction</a></li>
      <li><a href="#ancestral-state-reconstruction-2">Ancestral State Reconstruction</a></li>
      <li><a href="#ancestral-state-reconstruction-3">Ancestral State Reconstruction</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by April Wright.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
