<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bayesian Models • apb2019</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Bayesian Models">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">apb2019</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/RB_Discrete_Morphology/RB_MCMC_Discrete_Morph.html">Discrete morphology - Tree Inference</a>
    </li>
    <li>
      <a href="../../articles/RB_Total_Evidence/RB_Total_Evidence_Tutorial.html">RevBayes Total Evidence Tree Estimation</a>
    </li>
    <li>
      <a href="../../articles/R_exercises/00-installs.html">Installs</a>
    </li>
    <li>
      <a href="../../articles/R_exercises/01-treesiftr.html">treesifter GUI</a>
    </li>
    <li>
      <a href="../../articles/R_exercises/02-treesiftr-advanced.html">treesifter advanced</a>
    </li>
    <li>
      <a href="../../articles/R_exercises/03-FossilSim.html">FossilSim FBD Exercise</a>
    </li>
    <li>
      <a href="../../articles/lectures/BayesianModels.html">Bayesian Models</a>
    </li>
    <li>
      <a href="../../articles/lectures/CompMethods.html">Extended Morphology Models</a>
    </li>
    <li>
      <a href="../../articles/lectures/TreeThinking.html">Tree Thinking</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Bayesian Models</h1>
                        <h4 class="author">April Wright</h4>
            
            <h4 class="date">7.18.19</h4>
      
      
      <div class="hidden name"><code>BayesianModels.Rmd</code></div>

    </div>

    
    
<div id="dice-rolling-activity-and" class="section level2">
<h2 class="hasAnchor">
<a href="#dice-rolling-activity-and" class="anchor"></a>Dice Rolling Activity: AND</h2>
<p>Explain AND probability rule with dice roll</p>
</div>
<div id="dice-rolling-activity-and-1" class="section level2">
<h2 class="hasAnchor">
<a href="#dice-rolling-activity-and-1" class="anchor"></a>Dice Rolling Activity: AND</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(treesiftr)</span></code></pre></div>
<pre><code>## Registered S3 method overwritten by 'treeio':
##   method     from
##   root.phylo ape</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(alignfigR)</span></code></pre></div>
<pre><code>## Welcome to alignfigR!</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(phangorn)</span></code></pre></div>
<pre><code>## Loading required package: ape</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggtree)</span></code></pre></div>
<pre><code>## ggtree v1.16.3  For help: https://yulab-smu.github.io/treedata-book/
## 
## If you use ggtree in published research, please cite the most appropriate paper(s):
## 
## [36m-[39m Guangchuang Yu, Tommy Tsan-Yuk Lam, Huachen Zhu, Yi Guan. Two methods for mapping and visualizing associated data on phylogeny using ggtree. Molecular Biology and Evolution 2018, accepted. doi: 10.1093/molbev/msy194[36m-[39m Guangchuang Yu, David Smith, Huachen Zhu, Yi Guan, Tommy Tsan-Yuk Lam. ggtree: an R package for visualization and annotation of phylogenetic trees with their covariates and other associated data. Methods in Ecology and Evolution 2017, 8(1):28-36, doi:10.1111/2041-210X.12628</code></pre>
<pre><code>## 
## Attaching package: 'ggtree'</code></pre>
<pre><code>## The following object is masked from 'package:ape':
## 
##     rotate</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</span>
<span id="cb11-2"><a href="#cb11-2"></a>aln_path &lt;-<span class="st"> "../../data/bears_fasta.fa"</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>bears &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/alignfigR/topics/read_alignment">read_alignment</a></span>(aln_path)</span>
<span id="cb11-4"><a href="#cb11-4"></a>tree &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggtree/topics/reexports">read.tree</a></span>(<span class="st">"../../data/starting_tree.tre"</span>)</span>
<span id="cb11-5"><a href="#cb11-5"></a></span>
<span id="cb11-6"><a href="#cb11-6"></a>sample_df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/treesiftr/topics/generate_sliding">generate_sliding</a></span>(bears, <span class="dt">start_char =</span> <span class="dv">1</span>, <span class="dt">stop_char =</span> <span class="dv">2</span>, <span class="dt">steps =</span> <span class="dv">1</span>)</span>
<span id="cb11-7"><a href="#cb11-7"></a>output_vector &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/treesiftr/topics/generate_tree_vis">generate_tree_vis</a></span>(<span class="dt">sample_df =</span> sample_df, <span class="dt">alignment =</span>                                         aln_path, <span class="dt">tree =</span> tree, <span class="dt">phy_mat =</span> bears)</span></code></pre></div>
<pre><code>## Generating tree for charset:12</code></pre>
<pre><code>## Final p-score 2 after  0 nni operations</code></pre>
<pre><code>## Generating tree for charset:23</code></pre>
<pre><code>## Final p-score 2 after  0 nni operations</code></pre>
</div>
<div id="dice-rolling-activity-and-2" class="section level2">
<h2 class="hasAnchor">
<a href="#dice-rolling-activity-and-2" class="anchor"></a>Dice Rolling Activity: AND</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>output_vector[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>## NULL</code></pre>
</div>
<div id="dice-rolling-activity-or" class="section level2">
<h2 class="hasAnchor">
<a href="#dice-rolling-activity-or" class="anchor"></a>Dice Rolling Activity: OR</h2>
<p>Explain OR probability rule with dice roll</p>
</div>
<div id="dice-rolling-activity-and-3" class="section level2">
<h2 class="hasAnchor">
<a href="#dice-rolling-activity-and-3" class="anchor"></a>Dice Rolling Activity: AND</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>output_vector[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>## NULL</code></pre>
</div>
<div id="dice-rolling-activity-independence" class="section level2">
<h2 class="hasAnchor">
<a href="#dice-rolling-activity-independence" class="anchor"></a>Dice Rolling Activity: Independence</h2>
<p>Assumed to be independent: Probability of events rolling a 1 and rolling a 2 both occurring, if they are independent under AND:</p>
<p><span class="math inline">\(Pr(1,2) = Pr(1)Pr(2)\)</span></p>
</div>
<div id="dice-rolling-activity-independence-1" class="section level2">
<h2 class="hasAnchor">
<a href="#dice-rolling-activity-independence-1" class="anchor"></a>Dice Rolling Activity: Independence</h2>
<p>Assumed to be independent: Probability of events rolling a 1 and rolling a 2 both occurring, if they are independent under AND:</p>
<p><span class="math inline">\(Pr(1,2) = Pr(1)Pr(2)\)</span></p>
<ul>
<li>Do we expect that one dice roll is independent of the one prior to it?</li>
<li>Do we assume the probability of observing a 0 state at a tip is independent of state 0 being at its parent node?
<ul>
<li>Does OR feel right for this situation?</li>
</ul>
</li>
</ul>
</div>
<div id="dice-rolling-activity-non-independence" class="section level2">
<h2 class="hasAnchor">
<a href="#dice-rolling-activity-non-independence" class="anchor"></a>Dice Rolling Activity: Non-Independence</h2>
<p>When one outcome impacts the probability of the next outcome<br>
- The joint probability: <span class="math inline">\(Pr(A,B)\)</span><br>
- The probability of the first event: <span class="math inline">\(Pr(A)\)</span><br>
- The probability of the second event given the first: <span class="math inline">\(Pr(A|B)\)</span></p>
<p>??? Should be noted that this is not that dissimiliar to parsimony, since a change because pruning algorithm</p>
</div>
<div id="dice-rolling-activity-non-independence-1" class="section level2">
<h2 class="hasAnchor">
<a href="#dice-rolling-activity-non-independence-1" class="anchor"></a>Dice Rolling Activity: Non-Independence</h2>
<p>When one outcome impacts the probability of the next outcome - The joint probability: <span class="math inline">\(Pr(A,B)\)</span> - The probability of the first event: <span class="math inline">\(Pr(A)\)</span><br>
- The probability of the second event given the first: <span class="math inline">\(Pr(B|A)\)</span></p>
<p><span class="math inline">\(Pr(A,B) = Pr(A)Pr(B|A)\)</span></p>
</div>
<div id="dice-rolling-activity-non-independence-2" class="section level2">
<h2 class="hasAnchor">
<a href="#dice-rolling-activity-non-independence-2" class="anchor"></a>Dice Rolling Activity: Non-Independence</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>output_vector[<span class="dv">2</span>]</span></code></pre></div>
<pre><code>## [[1]]</code></pre>
<p><img src="BayesianModels_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div id="likelihood-how-do-we-turn-these-terms-into-a-model" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-how-do-we-turn-these-terms-into-a-model" class="anchor"></a>Likelihood: How do we turn these terms into a model?</h2>
<ul>
<li>One way to think about likelihood is as a degree of surprise
<ul>
<li>Would you be surprised if you rolled ten 1s in a row?<br>
</li>
<li>When we calculate a likelihood, we search for a maximum likelihood - the value that minimizes the degree of surprise given the data</li>
</ul>
</li>
</ul>
</div>
<div id="likelihood-model-expectations" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-model-expectations" class="anchor"></a>Likelihood: Model expectations</h2>
<table class="table">
<thead><tr class="header">
<th>Roll</th>
<th>Fair Die</th>
<th>Loaded Die</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1/6</td>
<td>2/6</td>
</tr>
<tr class="even">
<td>2</td>
<td>1/6</td>
<td>1/6</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1/6</td>
<td>1/6</td>
</tr>
<tr class="even">
<td>4</td>
<td>1/6</td>
<td>1/6</td>
</tr>
<tr class="odd">
<td>5</td>
<td>1/6</td>
<td>1/6</td>
</tr>
<tr class="even">
<td>6</td>
<td>1/6</td>
<td>0</td>
</tr>
</tbody>
</table>
</div>
<div id="likelihood-model-expectations-1" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-model-expectations-1" class="anchor"></a>Likelihood: Model expectations</h2>
<table class="table">
<thead><tr class="header">
<th>Roll</th>
<th>Fair Die</th>
<th>Loaded Die</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td><strong>1/6</strong></td>
<td>2/6</td>
</tr>
<tr class="even">
<td>2</td>
<td><strong>1/6</strong></td>
<td>1/6</td>
</tr>
<tr class="odd">
<td>3</td>
<td><strong>1/6</strong></td>
<td>1/6</td>
</tr>
<tr class="even">
<td>4</td>
<td><strong>1/6</strong></td>
<td>1/6</td>
</tr>
<tr class="odd">
<td>5</td>
<td><strong>1/6</strong></td>
<td>1/6</td>
</tr>
<tr class="even">
<td>6</td>
<td><strong>1/6</strong></td>
<td>0</td>
</tr>
</tbody>
</table>
<p>==1</p>
<p>Probabilities for each model will sum to 1</p>
</div>
<div id="likelihood-model-expectations-2" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-model-expectations-2" class="anchor"></a>Likelihood: Model expectations</h2>
<table class="table">
<thead><tr class="header">
<th>Roll</th>
<th>Fair Die</th>
<th>Loaded Die</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1/6</td>
<td><strong>2/6</strong></td>
</tr>
<tr class="even">
<td>2</td>
<td>1/6</td>
<td><strong>1/6</strong></td>
</tr>
<tr class="odd">
<td>3</td>
<td>1/6</td>
<td><strong>1/6</strong></td>
</tr>
<tr class="even">
<td>4</td>
<td>1/6</td>
<td><strong>1/6</strong></td>
</tr>
<tr class="odd">
<td>5</td>
<td>1/6</td>
<td><strong>1/6</strong></td>
</tr>
<tr class="even">
<td>6</td>
<td>1/6</td>
<td><strong>0/6</strong></td>
</tr>
</tbody>
</table>
<p>==1</p>
<p>Probabilities for each model will sum to 1</p>
</div>
<div id="likelihood-model-expectations-3" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-model-expectations-3" class="anchor"></a>Likelihood: Model expectations</h2>
<table class="table">
<thead><tr class="header">
<th>Roll</th>
<th>Fair Die</th>
<th>Loaded Die</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1/6</td>
<td><strong>2/6</strong></td>
</tr>
<tr class="even">
<td>2</td>
<td>1/6</td>
<td><strong>1/6</strong></td>
</tr>
<tr class="odd">
<td>3</td>
<td>1/6</td>
<td><strong>1/6</strong></td>
</tr>
<tr class="even">
<td>4</td>
<td>1/6</td>
<td><strong>1/6</strong></td>
</tr>
<tr class="odd">
<td>5</td>
<td>1/6</td>
<td><strong>1/6</strong></td>
</tr>
<tr class="even">
<td>6</td>
<td>1/6</td>
<td><strong>0/6</strong></td>
</tr>
</tbody>
</table>
<p>==1</p>
<p>What would be the probability of rolling 5 sixes under the first model?</p>
<p>Under the second?</p>
</div>
<div id="likelihood-in-phylogenetics" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-in-phylogenetics" class="anchor"></a>Likelihood in phylogenetics</h2>
<p><img src="img/L1.png" align="left" height="550" width="950" margin="0 auto"></p>
</div>
<div id="likelihood-in-phylogenetics-1" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-in-phylogenetics-1" class="anchor"></a>Likelihood in phylogenetics</h2>
<p><img src="img/L2.png" align="left" height="500" width="900" margin="0 auto"></p>
</div>
<div id="likelihood-in-phylogenetics-2" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-in-phylogenetics-2" class="anchor"></a>Likelihood in phylogenetics</h2>
<p><img src="img/L3.png" align="left" height="500" width="900" margin="0 auto"></p>
</div>
<div id="likelihood-in-phylogenetics-3" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-in-phylogenetics-3" class="anchor"></a>Likelihood in phylogenetics</h2>
<p><img src="img/L4.png" align="left" height="550" width="750" margin="0 auto"></p>
</div>
<div id="likelihood-sequence-models" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-sequence-models" class="anchor"></a>Likelihood: Sequence models</h2>
<p><img src="img/Assumptions1.png" align="left" height="550" width="750" margin="0 auto"></p>
</div>
<div id="likelihood-sequence-models-1" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-sequence-models-1" class="anchor"></a>Likelihood: Sequence models</h2>
<p><img src="img/Q1.png" align="left" height="550" width="750" margin="0 auto"></p>
</div>
<div id="likelihood-sequence-models-2" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-sequence-models-2" class="anchor"></a>Likelihood: Sequence models</h2>
<p><img src="img/Q2.png" align="left" height="550" width="750" margin="0 auto"></p>
</div>
<div id="likelihood-morphology-models" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-morphology-models" class="anchor"></a>Likelihood: Morphology models</h2>
<p><img src="img/Ant1.png" align="middle" height="350" width="350" margin="0 auto"></p>
</div>
<div id="likelihood-morphology-models-1" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-morphology-models-1" class="anchor"></a>Likelihood: Morphology models</h2>
<p><img src="img/ant2.png" align="left" height="550" width="750" margin="0 auto"></p>
</div>
<div id="likelihood-morphology-models-2" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-morphology-models-2" class="anchor"></a>Likelihood: Morphology models</h2>
<p><img src="img/ant3.png" align="left" height="550" width="750" margin="0 auto"></p>
</div>
<div id="likelihood-morphology-models-3" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-morphology-models-3" class="anchor"></a>Likelihood: Morphology models</h2>
<p><img src="img/ant4.png" align="left" height="550" width="750" margin="0 auto"></p>
</div>
<div id="likelihood-morphology-models-4" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-morphology-models-4" class="anchor"></a>Likelihood: Morphology models</h2>
<p><img src="img/ant5.png" align="left" height="550" width="750" margin="0 auto"></p>
</div>
<div id="likelihood-morphology-models-5" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-morphology-models-5" class="anchor"></a>Likelihood: Morphology models</h2>
<p><img src="img/ant6.png" align="left" height="550" width="750" margin="0 auto"></p>
</div>
<div id="likelihood-morphology-models-6" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-morphology-models-6" class="anchor"></a>Likelihood: Morphology models</h2>
<p><img src="img/ant7.png" align="left" height="550" width="750" margin="0 auto"></p>
</div>
<div id="likelihood-the-mk-model" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-the-mk-model" class="anchor"></a>Likelihood: The Mk Model</h2>
<ul>
<li>The main way morphological data is modeled in Bayesian and likelihood analysis is via the Mk model</li>
<li>Assumptions:
<ul>
<li>Characters are always in one of <em>k</em> states</li>
<li>Equally likely to transition to a state as from it</li>
<li>Changes can occur anywhere along the branch</li>
<li>Characters occur with equal frequency</li>
</ul>
</li>
</ul>
</div>
<div id="likelihood-the-mk-model-1" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-the-mk-model-1" class="anchor"></a>Likelihood: The Mk Model</h2>
<ul>
<li>The main way morphological data is modeled in Bayesian and likelihood analysis is via the Mk model</li>
<li>Assumptions:
<ul>
<li>Characters are always in one of <em>k</em> states</li>
<li>Equally likely to transition to a state as from it</li>
<li>Changes can occur anywhere along the branch</li>
<li>Characters occur with equal frequency</li>
</ul>
</li>
<li>This, to me, is the crucial difference between likelihood-based phylogenetics and parsimony: the assumptions are explicit, they are mathematically represented, and they are <em>testable</em>
</li>
</ul>
</div>
<div id="likelihood-the-mk-model-2" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-the-mk-model-2" class="anchor"></a>Likelihood: The Mk Model</h2>
<ul>
<li>The main way morphological data is modeled in Bayesian and likelihood analysis is via the Mk model</li>
<li>Assumptions:
<ul>
<li>Equally likely to transition to a state as from it</li>
</ul>
</li>
</ul>
</div>
<div id="likelihood-the-mk-model-3" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-the-mk-model-3" class="anchor"></a>Likelihood: The Mk Model</h2>
<ul>
<li>The main way morphological data is modeled in Bayesian and likelihood analysis is via the Mk model</li>
<li>Assumptions:
<ul>
<li>Equally likely to transition to a state as from it</li>
</ul>
</li>
</ul>
<p><span class="math inline">\(L\)</span></p>
</div>
<div id="likelihood-the-mk-model-4" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-the-mk-model-4" class="anchor"></a>Likelihood: The Mk Model</h2>
<ul>
<li>The main way morphological data is modeled in Bayesian and likelihood analysis is via the Mk model</li>
<li>Assumptions:
<ul>
<li>Equally likely to transition to a state as from it</li>
</ul>
</li>
</ul>
<p><span class="math inline">\(L = [(1/2)]\)</span></p>
</div>
<div id="likelihood-the-mk-model-5" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-the-mk-model-5" class="anchor"></a>Likelihood: The Mk Model</h2>
<ul>
<li>The main way morphological data is modeled in Bayesian and likelihood analysis is via the Mk model</li>
<li>Assumptions:
<ul>
<li>Changes can occur anywhere along the branch</li>
</ul>
</li>
</ul>
<p><span class="math inline">\(L = [(1/2)(1/2 + (1/2e^(-2v/1)))]\)</span> in which v is the branch length</p>
</div>
<div id="likelihood-the-mk-model-6" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-the-mk-model-6" class="anchor"></a>Likelihood: The Mk Model</h2>
<ul>
<li>Where do we get v from?</li>
</ul>
<p>v = substitution rate x time</p>
</div>
<div id="likelihood-the-mk-model-7" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-the-mk-model-7" class="anchor"></a>Likelihood: The Mk Model</h2>
<ul>
<li>OK, cool</li>
<li>How do we get the substitution rate?</li>
</ul>
</div>
<div id="likelihood-the-mk-model-8" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-the-mk-model-8" class="anchor"></a>Likelihood: The Mk Model</h2>
<ul>
<li>Let’s say we start with a character, 0
<ul>
<li>We’re going along a branch, and we have an event</li>
<li>We could … have an event that results in no change (still 0)</li>
<li>We could … have an event that results in change (to 1)
<ul>
<li>This is called a substitution</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div id="likelihood-the-mk-model-9" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-the-mk-model-9" class="anchor"></a>Likelihood: The Mk Model</h2>
<ul>
<li>There are only two possibilities for binary data - change or no change</li>
<li>We often refer to the substitution rate as <span class="math inline">\(\beta\)</span>
</li>
<li>The probability that any event happens, where it results in a change or not, is often called <span class="math inline">\(\mu\)</span>. <span class="math inline">\(\mu\)</span> for binary data is 2*<span class="math inline">\(\beta\)</span>
</li>
</ul>
</div>
<div id="likelihood-the-mk-model-10" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-the-mk-model-10" class="anchor"></a>Likelihood: The Mk Model</h2>
<ul>
<li>The waiting time between substitutions is Poisson-Distributed</li>
</ul>
</div>
<div id="likelihood-the-mk-model-11" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-the-mk-model-11" class="anchor"></a>Likelihood: The Mk Model</h2>
<ul>
<li><span class="math inline">\(\text{Pr(no events on branch)} = e^(-\mu*t)\)</span></li>
<li><span class="math inline">\(\text{Pr(something happens)} = 1 - e^(-\mu*t)\)</span></li>
<li><span class="math inline">\(\text{Pr(Any given event will cause us to change states)} = 1/2\)</span></li>
<li><span class="math inline">\(\text{Pr(1 at tip | 0 at node)} = (1/2)*1 - e^(-\mu*t)\)</span></li>
<li>$ = (1/2)*1 - e^(-2t) $</li>
</ul>
</div>
<div id="likelihood-the-mk-model-12" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-the-mk-model-12" class="anchor"></a>Likelihood: The Mk Model</h2>
<p>Break: treesiftr 6-10</p>
</div>
<div id="likelihood-branch-lengths" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-branch-lengths" class="anchor"></a>Likelihood: Branch lengths</h2>
<p>v is the number of substitutions per site<br>
- <span class="math inline">\(ν = (1/2) \mu*t = 2\beta*t\)</span><br>
- <span class="math inline">\(v/2 = \beta*t\)</span></p>
</div>
<div id="likelihood-the-mk-model-13" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-the-mk-model-13" class="anchor"></a>Likelihood: The Mk Model</h2>
<p>Break: <a href="http://phylo.bio.ku.edu/mephytis/tree-opt.html" class="uri">http://phylo.bio.ku.edu/mephytis/tree-opt.html</a></p>
</div>
<div id="likelihood-the-mk-model-14" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-the-mk-model-14" class="anchor"></a>Likelihood: The Mk Model</h2>
<ul>
<li>The main way morphological data is modeled in Bayesian and likelihood analysis is via the Mk model</li>
<li>Assumptions:
<ul>
<li>Characters occur with equal frequency</li>
</ul>
</li>
</ul>
</div>
<div id="likelihood-the-mk-model-15" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-the-mk-model-15" class="anchor"></a>Likelihood: The Mk Model</h2>
<ul>
<li>The main way morphological data is modeled in Bayesian and likelihood analysis is via the Mk model</li>
<li>Assumptions:
<ul>
<li>Characters occur with equal frequency</li>
<li>What is your probability of transitioning from 0 to 1 if all sites in your character matrix have 1 as their state?</li>
</ul>
</li>
</ul>
</div>
<div id="likelihood-the-mk-model-16" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-the-mk-model-16" class="anchor"></a>Likelihood: The Mk Model</h2>
<ul>
<li>The main way morphological data is modeled in Bayesian and likelihood analysis is via the Mk model</li>
<li>Assumptions:
<ul>
<li>Characters occur with equal frequency</li>
<li>What is your probability of transitioning from 0 to 1 if all sites in your character matrix have 1 as their state?</li>
</ul>
</li>
</ul>
<p><span class="math inline">\(\pi_{0}\)</span> and <span class="math inline">\(\pi_{1}\)</span></p>
<p><span class="math inline">\(L = \pi_{0}[1/2 + (1/2e)^(2v/1)]\)</span></p>
<p>This is just one branch and one character history!!!</p>
</div>
<div id="likelihood-the-mk-model-17" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-the-mk-model-17" class="anchor"></a>Likelihood: The Mk Model</h2>
<div class="figure">
<img src="img/Ptree_enum.png" alt=""><p class="caption">Parsimony Trees</p>
</div>
</div>
<div id="likelihood-the-mk-model-18" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-the-mk-model-18" class="anchor"></a>Likelihood: The Mk Model</h2>
<ul>
<li>The main way morphological data is modeled in Bayesian and likelihood analysis is via the Mk model</li>
<li>Assumptions:
<ul>
<li>Characters are always in one of <em>k</em> states</li>
<li>Equally likely to transition to a state as from it</li>
<li>Changes can occur anywhere along the branch</li>
<li>Characters occur with equal frequency</li>
</ul>
</li>
</ul>
</div>
<div id="likelihood-the-mk-model-19" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-the-mk-model-19" class="anchor"></a>Likelihood: The Mk Model</h2>
<ul>
<li>The main way morphological data is modeled in Bayesian and likelihood analysis is via the Mk model</li>
<li>Assumptions:
<ul>
<li>Characters are always in one of <em>k</em> states</li>
<li>Equally likely to transition to a state as from it</li>
<li>Changes can occur anywhere along the branch</li>
<li>Characters occur with equal frequency</li>
</ul>
</li>
</ul>
<p>Parsimony - minimize the number of steps on a tree. Score trees according to their number of steps</p>
</div>
<div id="likelihood-the-mk-model-20" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-the-mk-model-20" class="anchor"></a>Likelihood: The Mk Model</h2>
<ul>
<li>The main way morphological data is modeled in Bayesian and likelihood analysis is via the Mk model</li>
<li>Assumptions:
<ul>
<li>Characters are always in one of <em>k</em> states</li>
<li>Equally likely to transition to a state as from it</li>
<li>Changes can occur anywhere along the branch</li>
<li>Characters occur with equal frequency</li>
</ul>
</li>
</ul>
<p><span class="math inline">\(L = \text{Pr(Data | Tree, Branch lengths, other model parameters)}\)</span></p>
</div>
<div id="likelihood-the-mk-model-21" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-the-mk-model-21" class="anchor"></a>Likelihood: The Mk Model</h2>
<p>-Much about the evolutionary process assumed to have generated the data is similar betwen Mk and parsimony</p>
<p>-But also differences: under parsimony, every single character can have a different tree and length</p>
</div>
<div id="likelihood-gamma-distributed-rate-heterogeneity" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-gamma-distributed-rate-heterogeneity" class="anchor"></a>Likelihood: Gamma-Distributed Rate Heterogeneity</h2>
</div>
<div id="likelihood-gamma-distributed-rate-heterogeneity-1" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-gamma-distributed-rate-heterogeneity-1" class="anchor"></a>Likelihood: Gamma-Distributed Rate Heterogeneity</h2>
<ul>
<li>Do you think all characters evolve at the same rate?</li>
<li>Clarke and Middleton 2008 had a very nice exploration of this in birds</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)</span>
<span id="cb22-2"><a href="#cb22-2"></a>dat &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">draws =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/GammaDist">rgamma</a></span>(<span class="dt">n =</span> <span class="dv">500</span>, <span class="dt">shape =</span> <span class="dv">6</span>, <span class="dt">scale =</span> <span class="dv">10</span>),<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/GammaDist">rgamma</a></span>(<span class="dt">n =</span> <span class="dv">500</span>, <span class="dt">shape =</span> <span class="fl">.5</span>, <span class="dt">scale =</span> <span class="dv">10</span>)))</span>
<span id="cb22-3"><a href="#cb22-3"></a></span>
<span id="cb22-4"><a href="#cb22-4"></a>d2 &lt;-<span class="st"> </span>dat <span class="op">%&gt;%</span><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/dplyr/topics/summarise">summarize</a></span>(<span class="dt">lower =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/quantile">quantile</a></span>(dat<span class="op">$</span>draws, <span class="dt">probs =</span> <span class="fl">.25</span>), <span class="dt">middle =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/quantile">quantile</a></span>(dat<span class="op">$</span>draws, <span class="dt">probs =</span> <span class="fl">.5</span>), <span class="dt">seventyfive =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/quantile">quantile</a></span>(dat<span class="op">$</span>draws, <span class="dt">probs =</span> <span class="fl">.75</span>), <span class="dt">upper =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/quantile">quantile</a></span>(dat<span class="op">$</span>draws, <span class="dt">probs =</span> <span class="fl">.99</span>))</span>
<span id="cb22-5"><a href="#cb22-5"></a></span>
<span id="cb22-6"><a href="#cb22-6"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(dat, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x=</span>draws)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_density">geom_density</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_abline">geom_vline</a></span>(<span class="dt">data =</span> d2, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">xintercept =</span> lower)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_abline">geom_vline</a></span>(<span class="dt">data =</span> d2, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">xintercept =</span> middle)) <span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_abline">geom_vline</a></span>(<span class="dt">data =</span> d2, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">xintercept =</span> seventyfive)) <span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_abline">geom_vline</a></span>(<span class="dt">data =</span> d2, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">xintercept =</span> upper)) </span></code></pre></div>
<p><img src="BayesianModels_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>Less spread == evolutionary rates among characters <em>more</em> similar</p>
</div>
<div id="likelihood-gamma-distributed-rate-heterogeneity-2" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-gamma-distributed-rate-heterogeneity-2" class="anchor"></a>Likelihood: Gamma-Distributed Rate Heterogeneity</h2>
<p><img src="img/AIC.png" align="left" height="250" width="750" margin="0 auto"></p>
</div>
<div id="likelihood-the-mk-model-vs--parsimony" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-the-mk-model-vs--parsimony" class="anchor"></a>Likelihood: The Mk Model vs. Parsimony</h2>
<ul>
<li>I hope I’ve communicated to you that there are a lot of commonalities between parsimony and the most commonly used model for morphology</li>
</ul>
</div>
<div id="likelihood-the-mk-model-vs--parsimony-1" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-the-mk-model-vs--parsimony-1" class="anchor"></a>Likelihood: The Mk Model vs. Parsimony</h2>
<ul>
<li>Because I published this <img src="img/journal.pone.0109210.g003.png" align="left" height="500" width="450" margin="0 auto">
</li>
</ul>
<p>Wright and Hillis 2014</p>
</div>
<div id="likelihood-the-mk-model-vs--parsimony-2" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-the-mk-model-vs--parsimony-2" class="anchor"></a>Likelihood: The Mk Model vs. Parsimony</h2>
<ul>
<li>You’ll notice that parsimony really struggles when the evolutionary rate is high <img src="img/journal.pone.0109210.g003.png" align="left" height="500" width="450" margin="0 auto">
</li>
</ul>
</div>
<div id="likelihood-the-mk-model-vs--parsimony-3" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-the-mk-model-vs--parsimony-3" class="anchor"></a>Likelihood: The Mk Model vs. Parsimony</h2>
<ul>
<li>That’s because of this - parsimony will always try to minimize homoplasy. Likelihood methods can model multiple changes (superimposed changes) along a branch.</li>
</ul>
<div class="figure">
<img src="img/Ptree_enum.png" alt=""><p class="caption">Parsimony Trees</p>
</div>
</div>
<div id="long-branch-attraction" class="section level2">
<h2 class="hasAnchor">
<a href="#long-branch-attraction" class="anchor"></a>Long-Branch Attraction</h2>
<p><img src="img/felsenstein-zone-tree.png"></p>
<p>Felsenstein 1978</p>
</div>
<div id="a-brief-note-on-taxon-sampling" class="section level2">
<h2 class="hasAnchor">
<a href="#a-brief-note-on-taxon-sampling" class="anchor"></a>A brief note on taxon sampling</h2>
<p><img src="img/taxonsampling.png" alt="Zwickl Hillis"><img src="img/heathhedtke.png" alt="heath hedtke"></p>
</div>
<div id="a-brief-note-on-missing-data" class="section level2">
<h2 class="hasAnchor">
<a href="#a-brief-note-on-missing-data" class="anchor"></a>A brief note on missing data</h2>
<p>-Paleontological datasets tend to have a lot of missing data<br>
- In an analysis I did for Wright, Lloyd and Hillis (2016), I found most datasets falling in the 50-80% range</p>
</div>
<div id="a-brief-note-on-missing-data-1" class="section level2">
<h2 class="hasAnchor">
<a href="#a-brief-note-on-missing-data-1" class="anchor"></a>A brief note on missing data</h2>
<ul>
<li>According to some, missing data are no problem.</li>
</ul>
<p><img src="img/wiensMD.png"></p>
</div>
<div id="a-brief-note-on-missing-data-2" class="section level2">
<h2 class="hasAnchor">
<a href="#a-brief-note-on-missing-data-2" class="anchor"></a>A brief note on missing data</h2>
<ul>
<li>According to some, missing data are no problem.</li>
</ul>
<p><img src="img/wiensMD.png"></p>
</div>
<div id="a-brief-note-on-missing-data-3" class="section level2">
<h2 class="hasAnchor">
<a href="#a-brief-note-on-missing-data-3" class="anchor"></a>A brief note on missing data</h2>
<ul>
<li>According to others, it is</li>
</ul>
<p><img src="img/brownlemmon.png"></p>
</div>
<div id="a-brief-note-on-missing-data-4" class="section level2">
<h2 class="hasAnchor">
<a href="#a-brief-note-on-missing-data-4" class="anchor"></a>A brief note on missing data</h2>
<ul>
<li>Who is right?</li>
</ul>
</div>
<div id="a-brief-note-on-missing-data-5" class="section level2">
<h2 class="hasAnchor">
<a href="#a-brief-note-on-missing-data-5" class="anchor"></a>A brief note on missing data</h2>
<ul>
<li>Everyone, all at once<br><img src="img/wrightMD.png" align="left" height="500" width="450" margin="0 auto">
</li>
</ul>
</div>
<div id="bayesian-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#bayesian-methods" class="anchor"></a>Bayesian Methods</h2>
<ul>
<li>Can someone articulate for me a difference between a Bayesian method and a likelihood method?</li>
</ul>
</div>
<div id="bayesian-methods-1" class="section level2">
<h2 class="hasAnchor">
<a href="#bayesian-methods-1" class="anchor"></a>Bayesian Methods</h2>
<ul>
<li>Can someone articulate for me the difference between a Bayesian method and a likelihood method?</li>
</ul>
</div>
<div id="priors" class="section level2">
<h2 class="hasAnchor">
<a href="#priors" class="anchor"></a>Priors</h2>
<p><em>Priors reflect <em>prior</em> knowledge or work about a problem</em></p>
</div>
<div id="priors-1" class="section level2">
<h2 class="hasAnchor">
<a href="#priors-1" class="anchor"></a>Priors</h2>
<p><img src="img/manakins/manakins.001.png" align="left" height="500" width="750" margin="0 auto"></p>
</div>
<div id="taking-a-step-back" class="section level2">
<h2 class="hasAnchor">
<a href="#taking-a-step-back" class="anchor"></a>Taking a Step Back</h2>
<ul>
<li>What is the probability of a red head and yellow breast?<br>
</li>
<li>What is the probability of a red head and not-yellow breast?<br>
</li>
<li>What is the probability of a not-red head and yellow breast?<br>
</li>
<li>What is the probability of a not-red head and not-yellow breast?</li>
</ul>
</div>
<div id="joint-probabilities" class="section level2">
<h2 class="hasAnchor">
<a href="#joint-probabilities" class="anchor"></a>Joint Probabilities</h2>
<p>These are termed “joint” probabilities.</p>
<ul>
<li>What is the probability of a red head and yellow breast?<br>
</li>
<li>What is the probability of a red head and not-yellow breast?<br>
</li>
<li>What is the probability of a not-red head and yellow breast?<br>
</li>
<li>What is the probability of a not-red head and not-yellow breast?</li>
</ul>
</div>
<div id="conditional-probabilities" class="section level2">
<h2 class="hasAnchor">
<a href="#conditional-probabilities" class="anchor"></a>Conditional Probabilities</h2>
<p><img src="img/manakins/manakins.001.png" align="left" height="500" width="750" margin="0 auto"></p>
<ul>
<li>What is the probability that a manakin is yellow-breasted given that it is red-headed?</li>
</ul>
</div>
<div id="conditional-probabilities-1" class="section level2">
<h2 class="hasAnchor">
<a href="#conditional-probabilities-1" class="anchor"></a>Conditional Probabilities</h2>
<p><img src="img/manakins/manakins.001.png" align="left" height="500" width="750" margin="0 auto"></p>
<ul>
<li>What is the probability that a manakin is yellow-breasted given that it is red-headed? 3/5</li>
</ul>
<p>** This is the conditional probability **</p>
</div>
<div id="conditional-probabilities-2" class="section level2">
<h2 class="hasAnchor">
<a href="#conditional-probabilities-2" class="anchor"></a>Conditional Probabilities</h2>
<p><img src="img/manakins/manakins.001.png" align="left" height="500" width="750" margin="0 auto"></p>
<p>This is the conditional probability - It is the probability of yellow-beastedness given red-headedness,</p>
<p><span class="math inline">\(Pr(Y | R)( R )\)</span></p>
</div>
<div id="conditional-probabilities-3" class="section level2">
<h2 class="hasAnchor">
<a href="#conditional-probabilities-3" class="anchor"></a>Conditional Probabilities</h2>
<p><img src="img/manakins/manakins.001.png" align="left" height="500" width="750" margin="0 auto"> This is the conditional probability</p>
<p>Equally, it could be <span class="math inline">\(Pr(R | Y)(Y)\)</span></p>
</div>
<div id="conditional-probabilities-4" class="section level2">
<h2 class="hasAnchor">
<a href="#conditional-probabilities-4" class="anchor"></a>Conditional Probabilities</h2>
<p><img src="img/manakins/manakins.001.png" align="left" height="500" width="750" margin="0 auto"></p>
<p>This is the conditional probability - It is the probability of yellow-beastedness given red-headedness,</p>
<p><span class="math inline">\(Pr(Y | R)( R )\)</span></p>
</div>
<div id="conditional-probabilities-5" class="section level2">
<h2 class="hasAnchor">
<a href="#conditional-probabilities-5" class="anchor"></a>Conditional Probabilities</h2>
<p><img src="img/manakins/manakins.001.png" align="left" height="500" width="750" margin="0 auto"></p>
<p>This is the conditional probability</p>
<p><span class="math inline">\(\frac{(Pr(R | Y)Pr(Y))}{Pr(Y)} = \frac{(Pr(Y | R)Pr( R ))}{Pr(Y)}\)</span></p>
</div>
<div id="marginal-probabilities" class="section level2">
<h2 class="hasAnchor">
<a href="#marginal-probabilities" class="anchor"></a>Marginal Probabilities</h2>
<p><img src="img/manakins/manakins.001.png" align="left" height="500" width="750" margin="0 auto"></p>
<ul>
<li>What is the probability that a manakin is yellow-breasted?</li>
</ul>
</div>
<div id="marginal-probabilities-1" class="section level2">
<h2 class="hasAnchor">
<a href="#marginal-probabilities-1" class="anchor"></a>Marginal Probabilities</h2>
<p><img src="img/manakins/manakins.001.png" align="left" height="500" width="750" margin="0 auto"></p>
<ul>
<li>What is the probability that a manakin is yellow-breasted? 4/7</li>
</ul>
<p>This is a marginal probability</p>
</div>
<div id="marginal-probabilities-2" class="section level2">
<h2 class="hasAnchor">
<a href="#marginal-probabilities-2" class="anchor"></a>Marginal Probabilities</h2>
<p><img src="img/manakins/manakins.001.png" align="left" height="500" width="750" margin="0 auto"></p>
<ul>
<li>What is the probability that a manakin is yellow-breasted? 4/7</li>
</ul>
<p>This is a marginal probability</p>
<p><span class="math inline">\(Pr(Y) = Pr(Y, R) + Pr(Y, B)\)</span></p>
</div>
<div id="marginal-probabilities-3" class="section level2">
<h2 class="hasAnchor">
<a href="#marginal-probabilities-3" class="anchor"></a>Marginal Probabilities</h2>
<p><img src="img/manakins/manakins.001.png" align="left" height="500" width="750" margin="0 auto"> - What is the probability that a manakin is yellow-breasted? 4/7</p>
</div>
<div id="this-is-a-marginal-probability" class="section level2">
<h2 class="hasAnchor">
<a href="#this-is-a-marginal-probability" class="anchor"></a>This is a marginal probability</h2>
<p><span class="math inline">\(Pr(Y) = Pr(Y, R) + Pr(Y, B)\)</span></p>
<p>We’ll be coming back to this in a moment</p>
</div>
<div id="bayes-rule" class="section level2">
<h2 class="hasAnchor">
<a href="#bayes-rule" class="anchor"></a>Bayes Rule</h2>
<p>How do we calculate joint probabilities in a Bayesian context:</p>
<p><span class="math inline">\(Pr(R|Y) Pr(Y) = Pr(Y|R) Pr( R )\)</span></p>
</div>
<div id="bayes-rule-1" class="section level2">
<h2 class="hasAnchor">
<a href="#bayes-rule-1" class="anchor"></a>Bayes Rule</h2>
<p>If we divide byth sides by Pr(Y), we can simplify the statement</p>
<p><span class="math inline">\(\frac{(Pr(R | Y)Pr(Y))}{Pr(Y)} = \frac{(Pr(Y | R)Pr( R ))}{Pr(Y)}\)</span></p>
<p>Simplifies to:</p>
<p><span class="math inline">\(Pr(R|Y) = \frac{(Pr(Y | R)Pr( R ))}{Pr(Y)}\)</span></p>
</div>
<div id="bayes-rule-2" class="section level2">
<h2 class="hasAnchor">
<a href="#bayes-rule-2" class="anchor"></a>Bayes Rule</h2>
<p><span class="math inline">\(\frac{(Pr(R | Y)Pr(Y))}{Pr(Y)} = \frac{(Pr(Y | R)Pr( R ))}{Pr(Y)}\)</span></p>
<p>Simplifies to:</p>
<p><span class="math inline">\(_Pr(R|Y)_ = \frac{(Pr(Y | R)Pr( R ))}{Pr(Y)}\)</span></p>
<p>Posterior Probability of red-headedness</p>
</div>
<div id="bayes-rule-3" class="section level2">
<h2 class="hasAnchor">
<a href="#bayes-rule-3" class="anchor"></a>Bayes Rule</h2>
<p><span class="math inline">\(\frac{(Pr(R | Y)Pr(Y))}{Pr(Y)} = \frac{(Pr(Y | R)Pr( R ))}{Pr(Y)}\)</span></p>
<p>Simplifies to:</p>
<p><span class="math inline">\(Pr(R|Y) = \frac{(Pr(Y | R) Pr( R ))}{Pr(Y)}\)</span></p>
<p>Likelihood of Red-headed given Yellow-breasted</p>
</div>
<div id="bayes-rule-4" class="section level2">
<h2 class="hasAnchor">
<a href="#bayes-rule-4" class="anchor"></a>Bayes Rule</h2>
<p><span class="math inline">\(\frac{(Pr(R | Y)Pr(Y))}{Pr(Y)} = \frac{(Pr(Y | R)Pr( R ))}{Pr(Y)}\)</span></p>
<p>Simplifies to:</p>
<p><span class="math inline">\(Pr(R|Y) = \frac{(Pr(Y | R) Pr( R ))}{Pr(Y)}\)</span></p>
<p>Marginal likelihood of being yellow-breasted</p>
</div>
<div id="bayes-rule-5" class="section level2">
<h2 class="hasAnchor">
<a href="#bayes-rule-5" class="anchor"></a>Bayes Rule</h2>
<p><span class="math inline">\(\frac{(Pr(R | Y)Pr(Y))}{Pr(Y)} = \frac{(Pr(Y | R)Pr( R ))}{Pr(Y)}\)</span></p>
<p>Simplifies to:</p>
<p><span class="math inline">\(Pr(R|Y) = \frac{(Pr(Y | R) Pr( R ))}{Pr(Y)}\)</span></p>
<p>Prior probability of red-headedness</p>
</div>
<div id="priors-2" class="section level2">
<h2 class="hasAnchor">
<a href="#priors-2" class="anchor"></a>Priors</h2>
<p>Priors reflect <em>prior</em> knowledge or work about a problem</p>
<p>A prior can almost always be overcome by strong evidence</p>
</div>
<div id="bayes-rule-6" class="section level2">
<h2 class="hasAnchor">
<a href="#bayes-rule-6" class="anchor"></a>Bayes Rule</h2>
</div>
<div id="in-practice" class="section level1">
<h1 class="hasAnchor">
<a href="#in-practice" class="anchor"></a>In practice</h1>
<p>$Pr(Model Hypothesis | Data) =</p>
<p><span class="math inline">\(\frac{(Pr(Data | Model Hypothesis) Pr( Model Hypothesis ))}{Pr(Data)}\)</span></p>
<p><span class="math inline">\(Pr(Data)\)</span> derived via heuristics</p>
<div id="tree-searching-under-ml-and-bayesian-analyses" class="section level2">
<h2 class="hasAnchor">
<a href="#tree-searching-under-ml-and-bayesian-analyses" class="anchor"></a>Tree Searching Under ML and Bayesian Analyses</h2>
<div class="figure">
<img src="img/Ptree_enum.png" alt=""><p class="caption">Parsimony Trees</p>
</div>
<ul>
<li>We’ve covered that it is not practical to brute-force search trees<br>
</li>
<li>We’ve covered some heuristics<br>
</li>
<li>Parsimony heuristics can be simple - we are simply varying the topology<br>
</li>
<li>What happens when we need to vary topology, branch lengths and a bunch of model parameters?</li>
</ul>
</div>
<div id="mcmc-markov-chain-monte-carlo" class="section level2">
<h2 class="hasAnchor">
<a href="#mcmc-markov-chain-monte-carlo" class="anchor"></a>MCMC | Markov Chain Monte Carlo</h2>
<ul>
<li>This sounds intimidating, but let’s break it down a little bit<br>
</li>
<li>Markov chain: Memoryless process<br>
</li>
<li>Monte Carlo: Random proposals</li>
</ul>
</div>
<div id="mcmc-markov-chain-monte-carlo-1" class="section level2">
<h2 class="hasAnchor">
<a href="#mcmc-markov-chain-monte-carlo-1" class="anchor"></a>MCMC | Markov Chain Monte Carlo</h2>
<ul>
<li>This sounds intimidating, but let’s break it down a little bit</li>
<li>Markov chain: Memoryless process</li>
<li>Monte Carlo: Random proposals</li>
</ul>
<p>Put it together: we start with some value for a parameter, and make changes to it stoachstically. Then, we evaluate the likelihood score of that new parameter. If it is good, we keep it. If it is bad, we chuck it.</p>
</div>
<div id="mcmc" class="section level2">
<h2 class="hasAnchor">
<a href="#mcmc" class="anchor"></a>MCMC</h2>
<p>Put it together: we start with some value for a parameter, and make changes to it stoachstically. Then, we evaluate the likelihood score of that new parameter. If it is good, we use it to seed future searches. If it is bad, we keep our current value.</p>
<ul>
<li>Where does the lack of memory come in? And why is that a good thing?</li>
</ul>
</div>
<div id="mcmc-1" class="section level2">
<h2 class="hasAnchor">
<a href="#mcmc-1" class="anchor"></a>MCMC</h2>
<pre class="rev"><code>for (i in 1:nbr){
    br_lens[i] ~ dnExponential(br_len_lambda)
    moves[mvi++] = mvScale(br_lens[i]) 
}</code></pre>
<p>Let’s think about this in plain language. - Assign a length of each branch (drawn from a gamma) - Choose how the parameter will be changed (by scaling)</p>
</div>
<div id="mcmc-2" class="section level2">
<h2 class="hasAnchor">
<a href="#mcmc-2" class="anchor"></a>MCMC</h2>
<pre class="rev"><code>for (i in 1:nbr){
    br_lens[i] ~ dnExponential(br_len_lambda)
    moves[mvi++] = mvScale(br_lens[i]) 
}</code></pre>
<p>Let’s think about this in plain language. - A solution that is good will be hit many times</p>
</div>
<div id="mcmc-3" class="section level2">
<h2 class="hasAnchor">
<a href="#mcmc-3" class="anchor"></a>MCMC</h2>
<pre class="rev"><code>tau ~ dnUniformTopology(names)
moves[mvi++] = mvNNI(tau, weight=2*nbr)
phylogeny := treeAssembly(tau, br_lens)
moves[mvi++] = mvSPR(tau, weight=nbr)
</code></pre>
<blockquote>
<p>Let’s think about this in plain language. - Build an initial tree - Change it via SPR and NNI - What is the idea of weight?</p>
</blockquote>
</div>
<div id="mcmc-4" class="section level2">
<h2 class="hasAnchor">
<a href="#mcmc-4" class="anchor"></a>MCMC</h2>
<ul>
<li>Under ML: We use this to try to find a set of parameters that gives us the best model likelihood.<br>
</li>
<li>Under Bayesian: We use this to obtain a sample of models and parameters that show us the range of solutions for our data</li>
</ul>
</div>
<div id="bayes-rule-7" class="section level2">
<h2 class="hasAnchor">
<a href="#bayes-rule-7" class="anchor"></a>Bayes Rule</h2>
<p>Hands On: RB_Discrete_morphology, using priors to relax Mk assumptions</p>
<p>Hands On: RB_Discrete_morphology, analyzing the output Priors</p>
</div>
<div id="priors-reflect-prior-knowledge-or-work-about-a-problem" class="section level2">
<h2 class="hasAnchor">
<a href="#priors-reflect-prior-knowledge-or-work-about-a-problem" class="anchor"></a>Priors reflect <em>prior</em> knowledge or work about a problem</h2>
<p>We, for example, know that it is not incredibly likely to have super long branch lengths. Let’s look at that branch length prior again:</p>
<pre class="rev"><code>for (i in 1:nbr){
    br_lens[i] ~ dnExponential(br_len_lambda)
    moves[mvi++] = mvScale(br_lens[i]) 
}</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#dice-rolling-activity-and">Dice Rolling Activity: AND</a></li>
      <li><a href="#dice-rolling-activity-and-1">Dice Rolling Activity: AND</a></li>
      <li><a href="#dice-rolling-activity-and-2">Dice Rolling Activity: AND</a></li>
      <li><a href="#dice-rolling-activity-or">Dice Rolling Activity: OR</a></li>
      <li><a href="#dice-rolling-activity-and-3">Dice Rolling Activity: AND</a></li>
      <li><a href="#dice-rolling-activity-independence">Dice Rolling Activity: Independence</a></li>
      <li><a href="#dice-rolling-activity-independence-1">Dice Rolling Activity: Independence</a></li>
      <li><a href="#dice-rolling-activity-non-independence">Dice Rolling Activity: Non-Independence</a></li>
      <li><a href="#dice-rolling-activity-non-independence-1">Dice Rolling Activity: Non-Independence</a></li>
      <li><a href="#dice-rolling-activity-non-independence-2">Dice Rolling Activity: Non-Independence</a></li>
      <li><a href="#likelihood-how-do-we-turn-these-terms-into-a-model">Likelihood: How do we turn these terms into a model?</a></li>
      <li><a href="#likelihood-model-expectations">Likelihood: Model expectations</a></li>
      <li><a href="#likelihood-model-expectations-1">Likelihood: Model expectations</a></li>
      <li><a href="#likelihood-model-expectations-2">Likelihood: Model expectations</a></li>
      <li><a href="#likelihood-model-expectations-3">Likelihood: Model expectations</a></li>
      <li><a href="#likelihood-in-phylogenetics">Likelihood in phylogenetics</a></li>
      <li><a href="#likelihood-in-phylogenetics-1">Likelihood in phylogenetics</a></li>
      <li><a href="#likelihood-in-phylogenetics-2">Likelihood in phylogenetics</a></li>
      <li><a href="#likelihood-in-phylogenetics-3">Likelihood in phylogenetics</a></li>
      <li><a href="#likelihood-sequence-models">Likelihood: Sequence models</a></li>
      <li><a href="#likelihood-sequence-models-1">Likelihood: Sequence models</a></li>
      <li><a href="#likelihood-sequence-models-2">Likelihood: Sequence models</a></li>
      <li><a href="#likelihood-morphology-models">Likelihood: Morphology models</a></li>
      <li><a href="#likelihood-morphology-models-1">Likelihood: Morphology models</a></li>
      <li><a href="#likelihood-morphology-models-2">Likelihood: Morphology models</a></li>
      <li><a href="#likelihood-morphology-models-3">Likelihood: Morphology models</a></li>
      <li><a href="#likelihood-morphology-models-4">Likelihood: Morphology models</a></li>
      <li><a href="#likelihood-morphology-models-5">Likelihood: Morphology models</a></li>
      <li><a href="#likelihood-morphology-models-6">Likelihood: Morphology models</a></li>
      <li><a href="#likelihood-the-mk-model">Likelihood: The Mk Model</a></li>
      <li><a href="#likelihood-the-mk-model-1">Likelihood: The Mk Model</a></li>
      <li><a href="#likelihood-the-mk-model-2">Likelihood: The Mk Model</a></li>
      <li><a href="#likelihood-the-mk-model-3">Likelihood: The Mk Model</a></li>
      <li><a href="#likelihood-the-mk-model-4">Likelihood: The Mk Model</a></li>
      <li><a href="#likelihood-the-mk-model-5">Likelihood: The Mk Model</a></li>
      <li><a href="#likelihood-the-mk-model-6">Likelihood: The Mk Model</a></li>
      <li><a href="#likelihood-the-mk-model-7">Likelihood: The Mk Model</a></li>
      <li><a href="#likelihood-the-mk-model-8">Likelihood: The Mk Model</a></li>
      <li><a href="#likelihood-the-mk-model-9">Likelihood: The Mk Model</a></li>
      <li><a href="#likelihood-the-mk-model-10">Likelihood: The Mk Model</a></li>
      <li><a href="#likelihood-the-mk-model-11">Likelihood: The Mk Model</a></li>
      <li><a href="#likelihood-the-mk-model-12">Likelihood: The Mk Model</a></li>
      <li><a href="#likelihood-branch-lengths">Likelihood: Branch lengths</a></li>
      <li><a href="#likelihood-the-mk-model-13">Likelihood: The Mk Model</a></li>
      <li><a href="#likelihood-the-mk-model-14">Likelihood: The Mk Model</a></li>
      <li><a href="#likelihood-the-mk-model-15">Likelihood: The Mk Model</a></li>
      <li><a href="#likelihood-the-mk-model-16">Likelihood: The Mk Model</a></li>
      <li><a href="#likelihood-the-mk-model-17">Likelihood: The Mk Model</a></li>
      <li><a href="#likelihood-the-mk-model-18">Likelihood: The Mk Model</a></li>
      <li><a href="#likelihood-the-mk-model-19">Likelihood: The Mk Model</a></li>
      <li><a href="#likelihood-the-mk-model-20">Likelihood: The Mk Model</a></li>
      <li><a href="#likelihood-the-mk-model-21">Likelihood: The Mk Model</a></li>
      <li><a href="#likelihood-gamma-distributed-rate-heterogeneity">Likelihood: Gamma-Distributed Rate Heterogeneity</a></li>
      <li><a href="#likelihood-gamma-distributed-rate-heterogeneity-1">Likelihood: Gamma-Distributed Rate Heterogeneity</a></li>
      <li><a href="#likelihood-gamma-distributed-rate-heterogeneity-2">Likelihood: Gamma-Distributed Rate Heterogeneity</a></li>
      <li><a href="#likelihood-the-mk-model-vs--parsimony">Likelihood: The Mk Model vs. Parsimony</a></li>
      <li><a href="#likelihood-the-mk-model-vs--parsimony-1">Likelihood: The Mk Model vs. Parsimony</a></li>
      <li><a href="#likelihood-the-mk-model-vs--parsimony-2">Likelihood: The Mk Model vs. Parsimony</a></li>
      <li><a href="#likelihood-the-mk-model-vs--parsimony-3">Likelihood: The Mk Model vs. Parsimony</a></li>
      <li><a href="#long-branch-attraction">Long-Branch Attraction</a></li>
      <li><a href="#a-brief-note-on-taxon-sampling">A brief note on taxon sampling</a></li>
      <li><a href="#a-brief-note-on-missing-data">A brief note on missing data</a></li>
      <li><a href="#a-brief-note-on-missing-data-1">A brief note on missing data</a></li>
      <li><a href="#a-brief-note-on-missing-data-2">A brief note on missing data</a></li>
      <li><a href="#a-brief-note-on-missing-data-3">A brief note on missing data</a></li>
      <li><a href="#a-brief-note-on-missing-data-4">A brief note on missing data</a></li>
      <li><a href="#a-brief-note-on-missing-data-5">A brief note on missing data</a></li>
      <li><a href="#bayesian-methods">Bayesian Methods</a></li>
      <li><a href="#bayesian-methods-1">Bayesian Methods</a></li>
      <li><a href="#priors">Priors</a></li>
      <li><a href="#priors-1">Priors</a></li>
      <li><a href="#taking-a-step-back">Taking a Step Back</a></li>
      <li><a href="#joint-probabilities">Joint Probabilities</a></li>
      <li><a href="#conditional-probabilities">Conditional Probabilities</a></li>
      <li><a href="#conditional-probabilities-1">Conditional Probabilities</a></li>
      <li><a href="#conditional-probabilities-2">Conditional Probabilities</a></li>
      <li><a href="#conditional-probabilities-3">Conditional Probabilities</a></li>
      <li><a href="#conditional-probabilities-4">Conditional Probabilities</a></li>
      <li><a href="#conditional-probabilities-5">Conditional Probabilities</a></li>
      <li><a href="#marginal-probabilities">Marginal Probabilities</a></li>
      <li><a href="#marginal-probabilities-1">Marginal Probabilities</a></li>
      <li><a href="#marginal-probabilities-2">Marginal Probabilities</a></li>
      <li><a href="#marginal-probabilities-3">Marginal Probabilities</a></li>
      <li><a href="#this-is-a-marginal-probability">This is a marginal probability</a></li>
      <li><a href="#bayes-rule">Bayes Rule</a></li>
      <li><a href="#bayes-rule-1">Bayes Rule</a></li>
      <li><a href="#bayes-rule-2">Bayes Rule</a></li>
      <li><a href="#bayes-rule-3">Bayes Rule</a></li>
      <li><a href="#bayes-rule-4">Bayes Rule</a></li>
      <li><a href="#bayes-rule-5">Bayes Rule</a></li>
      <li><a href="#priors-2">Priors</a></li>
      <li><a href="#bayes-rule-6">Bayes Rule</a></li>
      <li>
<a href="#in-practice">In practice</a><ul class="nav nav-pills nav-stacked">
<li><a href="#tree-searching-under-ml-and-bayesian-analyses">Tree Searching Under ML and Bayesian Analyses</a></li>
      <li><a href="#mcmc-markov-chain-monte-carlo">MCMC | Markov Chain Monte Carlo</a></li>
      <li><a href="#mcmc-markov-chain-monte-carlo-1">MCMC | Markov Chain Monte Carlo</a></li>
      <li><a href="#mcmc">MCMC</a></li>
      <li><a href="#mcmc-1">MCMC</a></li>
      <li><a href="#mcmc-2">MCMC</a></li>
      <li><a href="#mcmc-3">MCMC</a></li>
      <li><a href="#mcmc-4">MCMC</a></li>
      <li><a href="#bayes-rule-7">Bayes Rule</a></li>
      <li><a href="#priors-reflect-prior-knowledge-or-work-about-a-problem">Priors reflect <em>prior</em> knowledge or work about a problem</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by April Wright.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
