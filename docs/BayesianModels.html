<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Bayesian Models • apb2019</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script>



<meta property="og:title" content="Bayesian Models" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-title-body">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">apb2019</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="articles/RB_Discrete_Morphology/RB_MCMC_Discrete_Morph.html">Discrete morphology - Tree Inference</a>
    </li>
    <li>
      <a href="articles/RB_Total_Evidence/RB_Total_Evidence_Tutorial.html">RevBayes Total Evidence Tree Estimation</a>
    </li>
    <li>
      <a href="articles/R_exercises/00-installs.html">Installs</a>
    </li>
    <li>
      <a href="articles/R_exercises/01-treesiftr.html">treesifter GUI</a>
    </li>
    <li>
      <a href="articles/R_exercises/02-treesiftr-advanced.html">treesifter advanced</a>
    </li>
    <li>
      <a href="articles/R_exercises/03-FossilSim.html">FossilSim FBD Exercise</a>
    </li>
    <li>
      <a href="articles/lectures/TreeThinking.html">Tree Thinking</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="contents col-md-9">
    <div class="page-header">
      <h1>Bayesian Models</h1>
    </div>


<div id="bayesian-models" class="section level1">

<p>author: April Wright date: 08.09.2018 autosize: true</p>
</div>
<div id="dice-rolling-activity-and" class="section level1">
<h1 class="hasAnchor">
<a href="#dice-rolling-activity-and" class="anchor"></a>Dice Rolling Activity: AND</h1>
<p>Explain AND probability rule with dice roll</p>
</div>
<div id="dice-rolling-activity-and-1" class="section level1">
<h1 class="hasAnchor">
<a href="#dice-rolling-activity-and-1" class="anchor"></a>Dice Rolling Activity: AND</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(treesiftr)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(alignfigR)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(phangorn)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggtree)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</span>
<span id="cb1-6"><a href="#cb1-6"></a>aln_path &lt;-<span class="st"> "data/bears_fasta.fa"</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>bears &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/alignfigR/topics/read_alignment">read_alignment</a></span>(aln_path)</span>
<span id="cb1-8"><a href="#cb1-8"></a>tree &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggtree/topics/reexports">read.tree</a></span>(<span class="st">"data/starting_tree.tre"</span>)</span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a>sample_df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/treesiftr/topics/generate_sliding">generate_sliding</a></span>(bears, <span class="dt">start_char =</span> <span class="dv">1</span>, <span class="dt">stop_char =</span> <span class="dv">2</span>, <span class="dt">steps =</span> <span class="dv">1</span>)</span>
<span id="cb1-11"><a href="#cb1-11"></a>output_vector &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/treesiftr/topics/generate_tree_vis">generate_tree_vis</a></span>(<span class="dt">sample_df =</span> sample_df, <span class="dt">alignment =</span>                                         aln_path, <span class="dt">tree =</span> tree, <span class="dt">phy_mat =</span> bears)</span></code></pre></div>
<pre><code>Final p-score 2 after  0 nni operations 
Final p-score 2 after  0 nni operations </code></pre>
</div>
<div id="dice-rolling-activity-and-2" class="section level1">
<h1 class="hasAnchor">
<a href="#dice-rolling-activity-and-2" class="anchor"></a>Dice Rolling Activity: AND</h1>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>output_vector[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>NULL</code></pre>
</div>
<div id="dice-rolling-activity-or" class="section level1">
<h1 class="hasAnchor">
<a href="#dice-rolling-activity-or" class="anchor"></a>Dice Rolling Activity: OR</h1>
<p>Explain OR probability rule with dice roll</p>
</div>
<div id="dice-rolling-activity-and-3" class="section level1">
<h1 class="hasAnchor">
<a href="#dice-rolling-activity-and-3" class="anchor"></a>Dice Rolling Activity: AND</h1>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>output_vector[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>NULL</code></pre>
</div>
<div id="dice-rolling-activity-independence" class="section level1">
<h1 class="hasAnchor">
<a href="#dice-rolling-activity-independence" class="anchor"></a>Dice Rolling Activity: Independence</h1>
<p>Assumed to be independent: Probability of events rolling a 1 and rolling a 2 both occurring, if they are independent under AND:</p>
<div id="pr12--pr1pr2" class="section level2">
<h2 class="hasAnchor">
<a href="#pr12--pr1pr2" class="anchor"></a>Pr(1,2) = Pr(1)Pr(2)</h2>
</div>
</div>
<div id="dice-rolling-activity-independence-1" class="section level1">
<h1 class="hasAnchor">
<a href="#dice-rolling-activity-independence-1" class="anchor"></a>Dice Rolling Activity: Independence</h1>
<p>Assumed to be independent: Probability of events rolling a 1 and rolling a 2 both occurring, if they are independent under AND:</p>
<div id="pr12--pr1pr2-1" class="section level2">
<h2 class="hasAnchor">
<a href="#pr12--pr1pr2-1" class="anchor"></a>Pr(1,2) = Pr(1)Pr(2)</h2>
<ul>
<li>Do we expect that one dice roll is independent of the one prior to it?</li>
<li>Do we assume the probability of observing a 0 state at a tip is independent of state 0 being at its parent node?
<ul>
<li>Does OR feel right for this situation?</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="dice-rolling-activity-non-independence" class="section level1">
<h1 class="hasAnchor">
<a href="#dice-rolling-activity-non-independence" class="anchor"></a>Dice Rolling Activity: Non-Independence</h1>
<p>When one outcome impacts the probability of the next outcome</p>
<ul>
<li>The joint probability: Pr(A,B)</li>
<li>The probability of the first event: Pr(A)</li>
<li>The probability of the second event given the first: Pr(A|B)</li>
</ul>
<p>??? Should be noted that this is not that dissimiliar to parsimony, since a change because pruning algorithm</p>
</div>
<div id="dice-rolling-activity-non-independence-1" class="section level1">
<h1 class="hasAnchor">
<a href="#dice-rolling-activity-non-independence-1" class="anchor"></a>Dice Rolling Activity: Non-Independence</h1>
<p>When one outcome impacts the probability of the next outcome</p>
<ul>
<li>The joint probability: Pr(A,B)</li>
<li>The probability of the first event: Pr(A)</li>
<li>The probability of the second event given the first: Pr(B|A)</li>
</ul>
<div id="prab--praprba" class="section level2">
<h2 class="hasAnchor">
<a href="#prab--praprba" class="anchor"></a>Pr(A,B) = Pr(A)Pr(B|A)</h2>
</div>
</div>
<div id="dice-rolling-activity-non-independence-2" class="section level1">
<h1 class="hasAnchor">
<a href="#dice-rolling-activity-non-independence-2" class="anchor"></a>Dice Rolling Activity: Non-Independence</h1>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>output_vector[<span class="dv">2</span>]</span></code></pre></div>
<pre><code>[[1]]</code></pre>
<p><img src="BayesianModels-figure/unnamed-chunk-4-1.png" alt="plot of chunk unnamed-chunk-4"></p>
</div>
<div id="likelihood-how-do-we-turn-these-terms-into-a-model" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-how-do-we-turn-these-terms-into-a-model" class="anchor"></a>Likelihood: How do we turn these terms into a model?</h1>
<ul>
<li>One way to think about likelihood is as a degree of surprise
<ul>
<li>Would you be surprised if you rolled ten 1s in a row?</li>
<li>When we calculate a likelihood, we search for a maximum likelihood - the value that minimizes the degree of surprise given the data</li>
</ul>
</li>
</ul>
</div>
<div id="likelihood-model-expectations" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-model-expectations" class="anchor"></a>Likelihood: Model expectations</h1>
<table>
<thead><tr class="header">
<th>Roll</th>
<th>Fair Die</th>
<th>Loaded Die</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1/6</td>
<td>2/6</td>
</tr>
<tr class="even">
<td>2</td>
<td>1/6</td>
<td>1/6</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1/6</td>
<td>1/6</td>
</tr>
<tr class="even">
<td>4</td>
<td>1/6</td>
<td>1/6</td>
</tr>
<tr class="odd">
<td>5</td>
<td>1/6</td>
<td>1/6</td>
</tr>
<tr class="even">
<td>6</td>
<td>1/6</td>
<td>0</td>
</tr>
</tbody>
</table>
</div>
<div id="likelihood-model-expectations-1" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-model-expectations-1" class="anchor"></a>Likelihood: Model expectations</h1>
<table>
<thead><tr class="header">
<th>Roll</th>
<th>Fair Die</th>
<th>Loaded Die</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td><strong>1/6</strong></td>
<td>2/6</td>
</tr>
<tr class="even">
<td>2</td>
<td><strong>1/6</strong></td>
<td>1/6</td>
</tr>
<tr class="odd">
<td>3</td>
<td><strong>1/6</strong></td>
<td>1/6</td>
</tr>
<tr class="even">
<td>4</td>
<td><strong>1/6</strong></td>
<td>1/6</td>
</tr>
<tr class="odd">
<td>5</td>
<td><strong>1/6</strong></td>
<td>1/6</td>
</tr>
<tr class="even">
<td>6</td>
<td><strong>1/6</strong></td>
<td>0</td>
</tr>
</tbody>
</table>
<p>==1</p>
<p>Probabilities for each model will sum to 1</p>
</div>
<div id="likelihood-model-expectations-2" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-model-expectations-2" class="anchor"></a>Likelihood: Model expectations</h1>
<table>
<thead><tr class="header">
<th>Roll</th>
<th>Fair Die</th>
<th>Loaded Die</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1/6</td>
<td><strong>2/6</strong></td>
</tr>
<tr class="even">
<td>2</td>
<td>1/6</td>
<td><strong>1/6</strong></td>
</tr>
<tr class="odd">
<td>3</td>
<td>1/6</td>
<td><strong>1/6</strong></td>
</tr>
<tr class="even">
<td>4</td>
<td>1/6</td>
<td><strong>1/6</strong></td>
</tr>
<tr class="odd">
<td>5</td>
<td>1/6</td>
<td><strong>1/6</strong></td>
</tr>
<tr class="even">
<td>6</td>
<td>1/6</td>
<td><strong>0/6</strong></td>
</tr>
</tbody>
</table>
<p>==1</p>
<p>Probabilities for each model will sum to 1</p>
</div>
<div id="likelihood-model-expectations-3" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-model-expectations-3" class="anchor"></a>Likelihood: Model expectations</h1>
<table>
<thead><tr class="header">
<th>Roll</th>
<th>Fair Die</th>
<th>Loaded Die</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1/6</td>
<td><strong>2/6</strong></td>
</tr>
<tr class="even">
<td>2</td>
<td>1/6</td>
<td><strong>1/6</strong></td>
</tr>
<tr class="odd">
<td>3</td>
<td>1/6</td>
<td><strong>1/6</strong></td>
</tr>
<tr class="even">
<td>4</td>
<td>1/6</td>
<td><strong>1/6</strong></td>
</tr>
<tr class="odd">
<td>5</td>
<td>1/6</td>
<td><strong>1/6</strong></td>
</tr>
<tr class="even">
<td>6</td>
<td>1/6</td>
<td><strong>0/6</strong></td>
</tr>
</tbody>
</table>
<p>==1</p>
<p>What would be the probability of rolling 5 sixes under the first model?</p>
<p>Under the second?</p>
</div>
<div id="likelihood-in-phylogenetics" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-in-phylogenetics" class="anchor"></a>Likelihood in phylogenetics</h1>
<p><img src="img/L1.png"></p>
</div>
<div id="likelihood-in-phylogenetics-1" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-in-phylogenetics-1" class="anchor"></a>Likelihood in phylogenetics</h1>
<p><img src="img/L2.png"></p>
</div>
<div id="likelihood-in-phylogenetics-2" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-in-phylogenetics-2" class="anchor"></a>Likelihood in phylogenetics</h1>
<p><img src="img/L3.png"></p>
</div>
<div id="likelihood-in-phylogenetics-3" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-in-phylogenetics-3" class="anchor"></a>Likelihood in phylogenetics</h1>
<p><img src="img/L4.png"></p>
</div>
<div id="likelihood-sequence-models" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-sequence-models" class="anchor"></a>Likelihood: Sequence models</h1>
<p><img src="img/Assumptions1.png"></p>
</div>
<div id="likelihood-sequence-models-1" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-sequence-models-1" class="anchor"></a>Likelihood: Sequence models</h1>
<p><img src="img/Q1.png"></p>
</div>
<div id="likelihood-sequence-models-2" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-sequence-models-2" class="anchor"></a>Likelihood: Sequence models</h1>
<p><img src="img/Q2.png"></p>
</div>
<div id="likelihood-morphology-models" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-morphology-models" class="anchor"></a>Likelihood: Morphology models</h1>
<p><img src="img/Ant1.png"></p>
</div>
<div id="likelihood-morphology-models-1" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-morphology-models-1" class="anchor"></a>Likelihood: Morphology models</h1>
<p><img src="img/Ant2.png"></p>
</div>
<div id="likelihood-morphology-models-2" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-morphology-models-2" class="anchor"></a>Likelihood: Morphology models</h1>
<p><img src="img/Ant3.png"><img src="img/Q2-state.png"></p>
</div>
<div id="likelihood-morphology-models-3" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-morphology-models-3" class="anchor"></a>Likelihood: Morphology models</h1>
<p><img src="img/Ant4.png"></p>
</div>
<div id="likelihood-morphology-models-4" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-morphology-models-4" class="anchor"></a>Likelihood: Morphology models</h1>
<p><img src="img/Ant5.png"><img src="img/Q4state.png"></p>
</div>
<div id="likelihood-morphology-models-5" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-morphology-models-5" class="anchor"></a>Likelihood: Morphology models</h1>
<p><img src="img/Ant6.png"></p>
</div>
<div id="likelihood-morphology-models-6" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-morphology-models-6" class="anchor"></a>Likelihood: Morphology models</h1>
<p><img src="img/Ant7.png"></p>
</div>
<div id="likelihood-the-mk-model" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-the-mk-model" class="anchor"></a>Likelihood: The Mk Model</h1>
<ul>
<li>The main way morphological data is modeled in Bayesian and likelihood analysis is via the Mk model</li>
<li>Assumptions:
<ul>
<li>Characters are always in one of <em>k</em> states</li>
<li>Equally likely to transition to a state as from it</li>
<li>Changes can occur anywhere along the branch</li>
<li>Characters occur with equal frequency</li>
</ul>
</li>
</ul>
</div>
<div id="likelihood-the-mk-model-1" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-the-mk-model-1" class="anchor"></a>Likelihood: The Mk Model</h1>
<ul>
<li>The main way morphological data is modeled in Bayesian and likelihood analysis is via the Mk model</li>
<li>Assumptions:
<ul>
<li>Characters are always in one of <em>k</em> states</li>
<li>Equally likely to transition to a state as from it</li>
<li>Changes can occur anywhere along the branch</li>
<li>Characters occur with equal frequency</li>
</ul>
</li>
<li>This, to me, is the crucial difference between likelihood-based phylogenetics and parsimony: the assumptions are explicit, they are mathematically represented, and they are <em>testable</em>
</li>
</ul>
</div>
<div id="likelihood-the-mk-model-2" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-the-mk-model-2" class="anchor"></a>Likelihood: The Mk Model</h1>
<ul>
<li>The main way morphological data is modeled in Bayesian and likelihood analysis is via the Mk model</li>
<li>Assumptions:
<ul>
<li>Equally likely to transition to a state as from it</li>
</ul>
</li>
</ul>
</div>
<div id="likelihood-the-mk-model-3" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-the-mk-model-3" class="anchor"></a>Likelihood: The Mk Model</h1>
<ul>
<li>The main way morphological data is modeled in Bayesian and likelihood analysis is via the Mk model</li>
<li>Assumptions:
<ul>
<li>Equally likely to transition to a state as from it</li>
</ul>
</li>
</ul>
</div>
<div id="l" class="section level1">
<h1 class="hasAnchor">
<a href="#l" class="anchor"></a>L</h1>
</div>
<div id="likelihood-the-mk-model-4" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-the-mk-model-4" class="anchor"></a>Likelihood: The Mk Model</h1>
<ul>
<li>The main way morphological data is modeled in Bayesian and likelihood analysis is via the Mk model</li>
<li>Assumptions:
<ul>
<li>Equally likely to transition to a state as from it</li>
</ul>
</li>
</ul>
</div>
<div id="l--12" class="section level1">
<h1 class="hasAnchor">
<a href="#l--12" class="anchor"></a>L = [(1/2)]</h1>
</div>
<div id="likelihood-the-mk-model-5" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-the-mk-model-5" class="anchor"></a>Likelihood: The Mk Model</h1>
<ul>
<li>The main way morphological data is modeled in Bayesian and likelihood analysis is via the Mk model</li>
<li>Assumptions:
<ul>
<li>Changes can occur anywhere along the branch</li>
</ul>
</li>
</ul>
</div>
<div id="l--1212--12e-2v1" class="section level1">
<h1 class="hasAnchor">
<a href="#l--1212--12e-2v1" class="anchor"></a>L = [(1/2)(1/2 + (1/2e^(-2v/1)))]</h1>
<p>in which v is the branch length</p>
</div>
<div id="likelihood-the-mk-model-6" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-the-mk-model-6" class="anchor"></a>Likelihood: The Mk Model</h1>
<ul>
<li>Where do we get v from?</li>
</ul>
<p>v = substitution rate x time</p>
</div>
<div id="likelihood-the-mk-model-7" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-the-mk-model-7" class="anchor"></a>Likelihood: The Mk Model</h1>
<ul>
<li>OK, cool</li>
<li>How do we get the substitution rate?</li>
</ul>
</div>
<div id="likelihood-the-mk-model-8" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-the-mk-model-8" class="anchor"></a>Likelihood: The Mk Model</h1>
<ul>
<li>Let’s say we start with a character, 0
<ul>
<li>We’re going along a branch, and we have an event</li>
<li>We could … have an event that results in no change (still 0)</li>
<li>We could … have an event that results in change (to 1)
<ul>
<li>This is called a substitution</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div id="likelihood-the-mk-model-9" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-the-mk-model-9" class="anchor"></a>Likelihood: The Mk Model</h1>
<ul>
<li>There are only two possibilities for binary data - change or no change</li>
<li>We often refer to the substitution rate as $\beta$</li>
<li>The probability that any event happens, where it results in a change or not, is often called $\mu$. $\mu$ for binary data is 2*$\beta$</li>
</ul>
</div>
<div id="likelihood-the-mk-model-10" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-the-mk-model-10" class="anchor"></a>Likelihood: The Mk Model</h1>
<ul>
<li>The waiting time between substitutions is Poisson-Distributed</li>
</ul>
</div>
<div id="likelihood-the-mk-model-11" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-the-mk-model-11" class="anchor"></a>Likelihood: The Mk Model</h1>
<div id="--prno-events-on-branch--e-mut" class="section level2">
<h2 class="hasAnchor">
<a href="#--prno-events-on-branch--e-mut" class="anchor"></a>- Pr(no events on branch) = e^(-$\mu$*t)</h2>
</div>
<div id="--prsomething-happens--1---e-mut" class="section level2">
<h2 class="hasAnchor">
<a href="#--prsomething-happens--1---e-mut" class="anchor"></a>- Pr(something happens) = 1 - e^(-$\mu$*t)</h2>
</div>
<div id="--prany-given-event-will-cause-us-to-change-states--12" class="section level2">
<h2 class="hasAnchor">
<a href="#--prany-given-event-will-cause-us-to-change-states--12" class="anchor"></a>- Pr(Any given event will cause us to change states) = 1/2</h2>
</div>
<div id="--pr1-at-tip--0-at-node--121---e-mut" class="section level2">
<h2 class="hasAnchor">
<a href="#--pr1-at-tip--0-at-node--121---e-mut" class="anchor"></a>- Pr(1 at tip | 0 at node) = (1/2)<em>1 - e^(-$\mu$</em>t)</h2>
</div>
<div id="--pr1-at-tip--0-at-node--121---e-2betat" class="section level2">
<h2 class="hasAnchor">
<a href="#--pr1-at-tip--0-at-node--121---e-2betat" class="anchor"></a>- Pr(1 at tip | 0 at node) = (1/2)<em>1 - e^(-2$\beta$</em>t)</h2>
</div>
</div>
<div id="likelihood-the-mk-model-12" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-the-mk-model-12" class="anchor"></a>Likelihood: The Mk Model</h1>
<p>Break: treesiftr 6-10</p>
</div>
<div id="likelihood-branch-lengths" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-branch-lengths" class="anchor"></a>Likelihood: Branch lengths</h1>
<div id="v-is-the-number-of-substitutions-per-site" class="section level2">
<h2 class="hasAnchor">
<a href="#v-is-the-number-of-substitutions-per-site" class="anchor"></a>v is the number of substitutions per site</h2>
</div>
<div id="--ν--12-mut--2betat" class="section level2">
<h2 class="hasAnchor">
<a href="#--%CE%BD--12-mut--2betat" class="anchor"></a>- ν = (1/2) $\mu$<em>t = 2$\beta$</em>t</h2>
</div>
<div id="--v2--betat" class="section level2">
<h2 class="hasAnchor">
<a href="#--v2--betat" class="anchor"></a>- v/2 = $\beta$*t</h2>
</div>
</div>
<div id="likelihood-the-mk-model-13" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-the-mk-model-13" class="anchor"></a>Likelihood: The Mk Model</h1>
<p>Break: <a href="http://phylo.bio.ku.edu/mephytis/tree-opt.html" class="uri">http://phylo.bio.ku.edu/mephytis/tree-opt.html</a></p>
</div>
<div id="likelihood-the-mk-model-14" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-the-mk-model-14" class="anchor"></a>Likelihood: The Mk Model</h1>
<ul>
<li>The main way morphological data is modeled in Bayesian and likelihood analysis is via the Mk model</li>
<li>Assumptions:
<ul>
<li>Characters occur with equal frequency</li>
</ul>
</li>
</ul>
</div>
<div id="likelihood-the-mk-model-15" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-the-mk-model-15" class="anchor"></a>Likelihood: The Mk Model</h1>
<ul>
<li>The main way morphological data is modeled in Bayesian and likelihood analysis is via the Mk model</li>
<li>Assumptions:
<ul>
<li>Characters occur with equal frequency</li>
<li>What is your probability of transitioning from 0 to 1 if all sites in your character matrix have 1 as their state?</li>
</ul>
</li>
</ul>
</div>
<div id="likelihood-the-mk-model-16" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-the-mk-model-16" class="anchor"></a>Likelihood: The Mk Model</h1>
<ul>
<li>The main way morphological data is modeled in Bayesian and likelihood analysis is via the Mk model</li>
<li>Assumptions:
<ul>
<li>Characters occur with equal frequency</li>
<li>What is your probability of transitioning from 0 to 1 if all sites in your character matrix have 1 as their state?</li>
</ul>
</li>
</ul>
<div id="pi_0-and-pi_1" class="section level2">
<h2 class="hasAnchor">
<a href="#pi_0-and-pi_1" class="anchor"></a>$\pi_{0}$ and $\pi_{1}$</h2>
</div>
<div id="l--pi_012--12e2v1" class="section level2">
<h2 class="hasAnchor">
<a href="#l--pi_012--12e2v1" class="anchor"></a>L = $\pi_{0}$[1/2 + (1/2e)^(2v/1)]</h2>
<p>This is just one branch and one character history!!!</p>
</div>
</div>
<div id="likelihood-the-mk-model-17" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-the-mk-model-17" class="anchor"></a>Likelihood: The Mk Model</h1>
<p><img src="img/Ptree_enum.png" alt="Parsimony Trees"></p>
</div>
<div id="likelihood-the-mk-model-18" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-the-mk-model-18" class="anchor"></a>Likelihood: The Mk Model</h1>
<ul>
<li>The main way morphological data is modeled in Bayesian and likelihood analysis is via the Mk model</li>
<li>Assumptions:
<ul>
<li>Characters are always in one of <em>k</em> states</li>
<li>Equally likely to transition to a state as from it</li>
<li>Changes can occur anywhere along the branch</li>
<li>Characters occur with equal frequency</li>
</ul>
</li>
</ul>
</div>
<div id="likelihood-the-mk-model-19" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-the-mk-model-19" class="anchor"></a>Likelihood: The Mk Model</h1>
<ul>
<li>The main way morphological data is modeled in Bayesian and likelihood analysis is via the Mk model</li>
<li>Assumptions:
<ul>
<li>Characters are always in one of <em>k</em> states</li>
<li>Equally likely to transition to a state as from it</li>
<li>Changes can occur anywhere along the branch</li>
<li>Characters occur with equal frequency</li>
</ul>
</li>
</ul>
</div>
<div id="parsimony---minimize-the-number-of-steps-on-a-tree-score-trees-according-to-their-number-of-steps" class="section level1">
<h1 class="hasAnchor">
<a href="#parsimony---minimize-the-number-of-steps-on-a-tree-score-trees-according-to-their-number-of-steps" class="anchor"></a>Parsimony - minimize the number of steps on a tree. Score trees according to their number of steps</h1>
</div>
<div id="likelihood-the-mk-model-20" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-the-mk-model-20" class="anchor"></a>Likelihood: The Mk Model</h1>
<ul>
<li>The main way morphological data is modeled in Bayesian and likelihood analysis is via the Mk model</li>
<li>Assumptions:
<ul>
<li>Characters are always in one of <em>k</em> states</li>
<li>Equally likely to transition to a state as from it</li>
<li>Changes can occur anywhere along the branch</li>
<li>Characters occur with equal frequency</li>
</ul>
</li>
</ul>
</div>
<div id="l--prdata--tree-branch-lengths-other-model-parameters" class="section level1">
<h1 class="hasAnchor">
<a href="#l--prdata--tree-branch-lengths-other-model-parameters" class="anchor"></a>L = Pr(Data | Tree, Branch lengths, other model parameters)</h1>
</div>
<div id="likelihood-the-mk-model-21" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-the-mk-model-21" class="anchor"></a>Likelihood: The Mk Model</h1>
<p>-Much about the evolutionary process assumed to have generated the data is similar betwen Mk and parsimony</p>
<p>-But also differences: under parsimony, every single character can have a different tree and length</p>
</div>
<div id="likelihood-gamma-distributed-rate-heterogeneity" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-gamma-distributed-rate-heterogeneity" class="anchor"></a>Likelihood: Gamma-Distributed Rate Heterogeneity</h1>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)</span>
<span id="cb9-2"><a href="#cb9-2"></a>dat &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">draws =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/GammaDist">rgamma</a></span>(<span class="dt">n =</span> <span class="dv">500</span>, <span class="dt">shape =</span> <span class="dv">2</span>, <span class="dt">scale =</span> <span class="dv">18</span>),<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/GammaDist">rgamma</a></span>(<span class="dt">n =</span> <span class="dv">500</span>, <span class="dt">shape =</span> <span class="fl">.5</span>, <span class="dt">scale =</span> <span class="dv">10</span>)))</span>
<span id="cb9-3"><a href="#cb9-3"></a></span>
<span id="cb9-4"><a href="#cb9-4"></a>d2 &lt;-<span class="st"> </span>dat <span class="op">%&gt;%</span><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/dplyr/topics/summarise">summarize</a></span>(<span class="dt">lower =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/quantile">quantile</a></span>(dat<span class="op">$</span>draws, <span class="dt">probs =</span> <span class="fl">.25</span>), <span class="dt">middle =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/quantile">quantile</a></span>(dat<span class="op">$</span>draws, <span class="dt">probs =</span> <span class="fl">.5</span>), <span class="dt">seventyfive =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/quantile">quantile</a></span>(dat<span class="op">$</span>draws, <span class="dt">probs =</span> <span class="fl">.75</span>), <span class="dt">upper =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/quantile">quantile</a></span>(dat<span class="op">$</span>draws, <span class="dt">probs =</span> <span class="fl">.99</span>))</span>
<span id="cb9-5"><a href="#cb9-5"></a></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/ggtree/topics/reexports">ggplot</a></span>(dat, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggtree/topics/reexports">aes</a></span>(<span class="dt">x=</span>draws)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_density">geom_density</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_abline">geom_vline</a></span>(<span class="dt">data =</span> d2, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggtree/topics/reexports">aes</a></span>(<span class="dt">xintercept =</span> lower)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_abline">geom_vline</a></span>(<span class="dt">data =</span> d2, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggtree/topics/reexports">aes</a></span>(<span class="dt">xintercept =</span> middle)) <span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_abline">geom_vline</a></span>(<span class="dt">data =</span> d2, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggtree/topics/reexports">aes</a></span>(<span class="dt">xintercept =</span> seventyfive)) <span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_abline">geom_vline</a></span>(<span class="dt">data =</span> d2, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggtree/topics/reexports">aes</a></span>(<span class="dt">xintercept =</span> upper)) </span></code></pre></div>
<p><img src="BayesianModels-figure/unnamed-chunk-5-1.png" alt="plot of chunk unnamed-chunk-5"></p>
</div>
<div id="likelihood-gamma-distributed-rate-heterogeneity-1" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-gamma-distributed-rate-heterogeneity-1" class="anchor"></a>Likelihood: Gamma-Distributed Rate Heterogeneity</h1>
<ul>
<li>Do you think all characters evolve at the same rate?</li>
<li>Clarke and Middleton 2008 had a very nice exploration of this in birds</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)</span>
<span id="cb10-2"><a href="#cb10-2"></a>dat &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">draws =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/GammaDist">rgamma</a></span>(<span class="dt">n =</span> <span class="dv">500</span>, <span class="dt">shape =</span> <span class="dv">6</span>, <span class="dt">scale =</span> <span class="dv">10</span>),<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/GammaDist">rgamma</a></span>(<span class="dt">n =</span> <span class="dv">500</span>, <span class="dt">shape =</span> <span class="fl">.5</span>, <span class="dt">scale =</span> <span class="dv">10</span>)))</span>
<span id="cb10-3"><a href="#cb10-3"></a></span>
<span id="cb10-4"><a href="#cb10-4"></a>d2 &lt;-<span class="st"> </span>dat <span class="op">%&gt;%</span><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/dplyr/topics/summarise">summarize</a></span>(<span class="dt">lower =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/quantile">quantile</a></span>(dat<span class="op">$</span>draws, <span class="dt">probs =</span> <span class="fl">.25</span>), <span class="dt">middle =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/quantile">quantile</a></span>(dat<span class="op">$</span>draws, <span class="dt">probs =</span> <span class="fl">.5</span>), <span class="dt">seventyfive =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/quantile">quantile</a></span>(dat<span class="op">$</span>draws, <span class="dt">probs =</span> <span class="fl">.75</span>), <span class="dt">upper =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/quantile">quantile</a></span>(dat<span class="op">$</span>draws, <span class="dt">probs =</span> <span class="fl">.99</span>))</span>
<span id="cb10-5"><a href="#cb10-5"></a></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/ggtree/topics/reexports">ggplot</a></span>(dat, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggtree/topics/reexports">aes</a></span>(<span class="dt">x=</span>draws)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_density">geom_density</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_abline">geom_vline</a></span>(<span class="dt">data =</span> d2, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggtree/topics/reexports">aes</a></span>(<span class="dt">xintercept =</span> lower)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_abline">geom_vline</a></span>(<span class="dt">data =</span> d2, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggtree/topics/reexports">aes</a></span>(<span class="dt">xintercept =</span> middle)) <span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_abline">geom_vline</a></span>(<span class="dt">data =</span> d2, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggtree/topics/reexports">aes</a></span>(<span class="dt">xintercept =</span> seventyfive)) <span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_abline">geom_vline</a></span>(<span class="dt">data =</span> d2, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggtree/topics/reexports">aes</a></span>(<span class="dt">xintercept =</span> upper)) </span></code></pre></div>
<p><img src="BayesianModels-figure/unnamed-chunk-6-1.png" alt="plot of chunk unnamed-chunk-6"></p>
<div id="less-spread--evolutionary-rates-among-characters-more-similar" class="section level2">
<h2 class="hasAnchor">
<a href="#less-spread--evolutionary-rates-among-characters-more-similar" class="anchor"></a>Less spread == evolutionary rates among characters <em>more</em> similar</h2>
</div>
</div>
<div id="likelihood-gamma-distributed-rate-heterogeneity-2" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-gamma-distributed-rate-heterogeneity-2" class="anchor"></a>Likelihood: Gamma-Distributed Rate Heterogeneity</h1>
<p><img src="img/AIC.png"></p>
</div>
<div id="likelihood-the-mk-model-vs-parsimony" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-the-mk-model-vs-parsimony" class="anchor"></a>Likelihood: The Mk Model vs. Parsimony</h1>
<ul>
<li>I hope I’ve communicated to you that there are a lot of commonalities between parsimony and the most commonly used model for morphology</li>
</ul>
</div>
<div id="likelihood-the-mk-model-vs-parsimony-1" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-the-mk-model-vs-parsimony-1" class="anchor"></a>Likelihood: The Mk Model vs. Parsimony</h1>
<ul>
<li>Because I published this <img src="img/journal.pone.0109210.g003.png">
</li>
</ul>
<p>Wright and Hillis 2014</p>
</div>
<div id="likelihood-the-mk-model-vs-parsimony-2" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-the-mk-model-vs-parsimony-2" class="anchor"></a>Likelihood: The Mk Model vs. Parsimony</h1>
<ul>
<li>You’ll notice that parsimony really struggles when the evolutionary rate is high <img src="img/journal.pone.0109210.g003.png">
</li>
</ul>
</div>
<div id="likelihood-the-mk-model-vs-parsimony-3" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-the-mk-model-vs-parsimony-3" class="anchor"></a>Likelihood: The Mk Model vs. Parsimony</h1>
<ul>
<li>That’s because of this - parsimony will always try to minimize homoplasy. Likelihood methods can model multiple changes (superimposed changes) along a branch.</li>
</ul>
<p><img src="img/Ptree_enum.png" alt="Parsimony Trees"></p>
</div>
<div id="long-branch-attraction" class="section level1">
<h1 class="hasAnchor">
<a href="#long-branch-attraction" class="anchor"></a>Long-Branch Attraction</h1>
<p><img src="img/felsenstein-zone-tree.png"></p>
<p>Felsenstein 1978</p>
</div>
<div id="a-brief-note-on-taxon-sampling" class="section level1">
<h1 class="hasAnchor">
<a href="#a-brief-note-on-taxon-sampling" class="anchor"></a>A brief note on taxon sampling</h1>
<p><img src="img/taxonsampling.png" alt="Zwickl Hillis"><img src="img/heathhedtke.png" alt="heath hedtke"></p>
</div>
<div id="a-brief-note-on-missing-data" class="section level1">
<h1 class="hasAnchor">
<a href="#a-brief-note-on-missing-data" class="anchor"></a>A brief note on missing data</h1>
<p>-Paleontological datasets tend to have a lot of missing data</p>
<ul>
<li>In an analysis I did for Wright, Lloyd and Hillis (2016), I found most datasets falling in the 50-80% range</li>
</ul>
</div>
<div id="a-brief-note-on-missing-data-1" class="section level1">
<h1 class="hasAnchor">
<a href="#a-brief-note-on-missing-data-1" class="anchor"></a>A brief note on missing data</h1>
<ul>
<li>According to some, missing data are no problem.</li>
</ul>
<p><img src="img/wiensMD.png"></p>
</div>
<div id="a-brief-note-on-missing-data-2" class="section level1">
<h1 class="hasAnchor">
<a href="#a-brief-note-on-missing-data-2" class="anchor"></a>A brief note on missing data</h1>
<ul>
<li>According to some, missing data are no problem.</li>
</ul>
<p><img src="img/wiensMD.png"></p>
</div>
<div id="a-brief-note-on-missing-data-3" class="section level1">
<h1 class="hasAnchor">
<a href="#a-brief-note-on-missing-data-3" class="anchor"></a>A brief note on missing data</h1>
<ul>
<li>According to others, it is</li>
</ul>
<p><img src="img/brownlemmon.png"></p>
</div>
<div id="a-brief-note-on-missing-data-4" class="section level1">
<h1 class="hasAnchor">
<a href="#a-brief-note-on-missing-data-4" class="anchor"></a>A brief note on missing data</h1>
<ul>
<li>Who is right?</li>
</ul>
</div>
<div id="a-brief-note-on-missing-data-5" class="section level1">
<h1 class="hasAnchor">
<a href="#a-brief-note-on-missing-data-5" class="anchor"></a>A brief note on missing data</h1>
<ul>
<li>Everyone, all at once</li>
</ul>
<p><img src="img/wrightMD.png"></p>
</div>
<div id="a-brief-note-on-missing-data-6" class="section level1">
<h1 class="hasAnchor">
<a href="#a-brief-note-on-missing-data-6" class="anchor"></a>A brief note on missing data</h1>
<ul>
<li>Everyone, all at once</li>
</ul>
<p><img src="img/wrightMD.png"><img src="img/wrightPMD.png"></p>
</div>
<div id="bayesian-methods" class="section level1">
<h1 class="hasAnchor">
<a href="#bayesian-methods" class="anchor"></a>Bayesian Methods</h1>
<ul>
<li>Can someone articulate for me a difference between a Bayesian method and a likelihood method?</li>
</ul>
</div>
<div id="bayesian-methods-1" class="section level1">
<h1 class="hasAnchor">
<a href="#bayesian-methods-1" class="anchor"></a>Bayesian Methods</h1>
<ul>
<li>Can someone articulate for me the difference between a Bayesian method and a likelihood method?</li>
</ul>
</div>
<div id="priors" class="section level1">
<h1 class="hasAnchor">
<a href="#priors" class="anchor"></a>Priors</h1>
<div id="priors-reflect-prior-knowledge-or-work-about-a-problem" class="section level2">
<h2 class="hasAnchor">
<a href="#priors-reflect-prior-knowledge-or-work-about-a-problem" class="anchor"></a>Priors reflect <em>prior</em> knowledge or work about a problem</h2>
</div>
</div>
<div id="priors-1" class="section level1">
<h1 class="hasAnchor">
<a href="#priors-1" class="anchor"></a>Priors</h1>
<p><img src="img/manakins/manakins.001.png" alt="manakins"></p>
</div>
<div id="taking-a-step-back" class="section level1">
<h1 class="hasAnchor">
<a href="#taking-a-step-back" class="anchor"></a>Taking a Step Back</h1>
<p><img src="img/manakins/manakins.001.png" alt="manakins"></p>
<ul>
<li>What is the probability of a red head and yellow breast?<br>
</li>
<li>What is the probability of a red head and not-yellow breast?<br>
</li>
<li>What is the probability of a not-red head and yellow breast?<br>
</li>
<li>What is the probability of a not-red head and not-yellow breast?</li>
</ul>
</div>
<div id="joint-probabilities" class="section level1">
<h1 class="hasAnchor">
<a href="#joint-probabilities" class="anchor"></a>Joint Probabilities</h1>
<div id="these-are-termed-joint-probabilities" class="section level2">
<h2 class="hasAnchor">
<a href="#these-are-termed-joint-probabilities" class="anchor"></a>These are termed “joint” probabilities.</h2>
<ul>
<li>What is the probability of a red head and yellow breast?<br>
</li>
<li>What is the probability of a red head and not-yellow breast?<br>
</li>
<li>What is the probability of a not-red head and yellow breast?<br>
</li>
<li>What is the probability of a not-red head and not-yellow breast?</li>
</ul>
</div>
</div>
<div id="conditional-probabilities" class="section level1">
<h1 class="hasAnchor">
<a href="#conditional-probabilities" class="anchor"></a>Conditional Probabilities</h1>
<p><img src="img/manakins/manakins.001.png" alt="manakins height=4in"></p>
<ul>
<li>What is the probability that a manakin is yellow-breasted given that it is red-headed?</li>
</ul>
</div>
<div id="conditional-probabilities-1" class="section level1">
<h1 class="hasAnchor">
<a href="#conditional-probabilities-1" class="anchor"></a>Conditional Probabilities</h1>
<p><img src="img/manakins/manakins.001.png" alt="manakins"></p>
<ul>
<li>What is the probability that a manakin is yellow-breasted given that it is red-headed? 3/5</li>
</ul>
<div id="this-is-the-conditional-probability" class="section level2">
<h2 class="hasAnchor">
<a href="#this-is-the-conditional-probability" class="anchor"></a>This is the conditional probability</h2>
</div>
</div>
<div id="conditional-probabilities-2" class="section level1">
<h1 class="hasAnchor">
<a href="#conditional-probabilities-2" class="anchor"></a>Conditional Probabilities</h1>
<p><img src="img/manakins/manakins.001.png" alt="manakins"></p>
<div id="this-is-the-conditional-probability-1" class="section level2">
<h2 class="hasAnchor">
<a href="#this-is-the-conditional-probability-1" class="anchor"></a>This is the conditional probability</h2>
<ul>
<li>It is the probability of yellow-beastedness given red-headedness,</li>
</ul>
</div>
<div id="pry--r-r-" class="section level2">
<h2 class="hasAnchor">
<a href="#pry--r-r-" class="anchor"></a>Pr(Y | R)( R )</h2>
</div>
</div>
<div id="conditional-probabilities-3" class="section level1">
<h1 class="hasAnchor">
<a href="#conditional-probabilities-3" class="anchor"></a>Conditional Probabilities</h1>
<p><img src="img/manakins/manakins.001.png" alt="manakins"></p>
<div id="this-is-the-conditional-probability-2" class="section level2">
<h2 class="hasAnchor">
<a href="#this-is-the-conditional-probability-2" class="anchor"></a>This is the conditional probability</h2>
</div>
<div id="equally-it-could-be-prr--yy" class="section level2">
<h2 class="hasAnchor">
<a href="#equally-it-could-be-prr--yy" class="anchor"></a>Equally, it could be Pr(R | Y)(Y)</h2>
</div>
</div>
<div id="conditional-probabilities-4" class="section level1">
<h1 class="hasAnchor">
<a href="#conditional-probabilities-4" class="anchor"></a>Conditional Probabilities</h1>
<p><img src="img/manakins/manakins.001.png" alt="manakins"></p>
<div id="this-is-the-conditional-probability-3" class="section level2">
<h2 class="hasAnchor">
<a href="#this-is-the-conditional-probability-3" class="anchor"></a>This is the conditional probability</h2>
<ul>
<li>It is the probability of yellow-beastedness given red-headedness,</li>
</ul>
</div>
<div id="pry--r-r--1" class="section level2">
<h2 class="hasAnchor">
<a href="#pry--r-r--1" class="anchor"></a>Pr(Y | R)( R )</h2>
</div>
</div>
<div id="conditional-probabilities-5" class="section level1">
<h1 class="hasAnchor">
<a href="#conditional-probabilities-5" class="anchor"></a>Conditional Probabilities</h1>
<p><img src="img/manakins/manakins.001.png" alt="manakins"></p>
<div id="this-is-the-conditional-probability-4" class="section level2">
<h2 class="hasAnchor">
<a href="#this-is-the-conditional-probability-4" class="anchor"></a>This is the conditional probability</h2>
</div>
</div>
<div id="fracprr--yprypry--fracpry--rpr-r-pry" class="section level1">
<h1 class="hasAnchor">
<a href="#fracprr--yprypry--fracpry--rpr-r-pry" class="anchor"></a>$\frac{(Pr(R | Y)Pr(Y))}{Pr(Y)}$ = $\frac{(Pr(Y | R)Pr( R ))}{Pr(Y)}$</h1>
</div>
<div id="marginal-probabilities" class="section level1">
<h1 class="hasAnchor">
<a href="#marginal-probabilities" class="anchor"></a>Marginal Probabilities</h1>
<p><img src="img/manakins/manakins.001.png" alt="manakins"></p>
<ul>
<li>What is the probability that a manakin is yellow-breasted?</li>
</ul>
</div>
<div id="marginal-probabilities-1" class="section level1">
<h1 class="hasAnchor">
<a href="#marginal-probabilities-1" class="anchor"></a>Marginal Probabilities</h1>
<p><img src="img/manakins/manakins.001.png" alt="manakins"></p>
<ul>
<li>What is the probability that a manakin is yellow-breasted? 4/7</li>
</ul>
<div id="this-is-a-marginal-probability" class="section level2">
<h2 class="hasAnchor">
<a href="#this-is-a-marginal-probability" class="anchor"></a>This is a marginal probability</h2>
</div>
</div>
<div id="marginal-probabilities-2" class="section level1">
<h1 class="hasAnchor">
<a href="#marginal-probabilities-2" class="anchor"></a>Marginal Probabilities</h1>
<p><img src="img/manakins/manakins.001.png" alt="manakins"></p>
<ul>
<li>What is the probability that a manakin is yellow-breasted? 4/7</li>
</ul>
<div id="this-is-a-marginal-probability-1" class="section level2">
<h2 class="hasAnchor">
<a href="#this-is-a-marginal-probability-1" class="anchor"></a>This is a marginal probability</h2>
</div>
<div id="pry--pry-r--pry-b" class="section level2">
<h2 class="hasAnchor">
<a href="#pry--pry-r--pry-b" class="anchor"></a>Pr(Y) = Pr(Y, R) + Pr(Y, B)</h2>
</div>
</div>
<div id="marginal-probabilities-3" class="section level1">
<h1 class="hasAnchor">
<a href="#marginal-probabilities-3" class="anchor"></a>Marginal Probabilities</h1>
<p><img src="img/manakins/manakins.001.png" alt="manakins"></p>
<ul>
<li>What is the probability that a manakin is yellow-breasted? 4/7</li>
</ul>
<div id="this-is-a-marginal-probability-2" class="section level2">
<h2 class="hasAnchor">
<a href="#this-is-a-marginal-probability-2" class="anchor"></a>This is a marginal probability</h2>
</div>
<div id="pry--pry-r--pry-b-1" class="section level2">
<h2 class="hasAnchor">
<a href="#pry--pry-r--pry-b-1" class="anchor"></a>Pr(Y) = Pr(Y, R) + Pr(Y, B)</h2>
</div>
<div id="well-be-coming-back-to-this-in-a-moment" class="section level2">
<h2 class="hasAnchor">
<a href="#well-be-coming-back-to-this-in-a-moment" class="anchor"></a>We’ll be coming back to this in a moment</h2>
</div>
</div>
<div id="bayes-rule" class="section level1">
<h1 class="hasAnchor">
<a href="#bayes-rule" class="anchor"></a>Bayes Rule</h1>
<p>How do we calculate joint probabilities in a Bayesian context:</p>
</div>
<div id="prry-pry--pryr-pr-r-" class="section level1">
<h1 class="hasAnchor">
<a href="#prry-pry--pryr-pr-r-" class="anchor"></a>Pr(R|Y) Pr(Y) = Pr(Y|R) Pr( R )</h1>
</div>
<div id="bayes-rule-1" class="section level1">
<h1 class="hasAnchor">
<a href="#bayes-rule-1" class="anchor"></a>Bayes Rule</h1>
</div>
<div id="if-we-divide-byth-sides-by-pry-we-can-simplify-the-statement" class="section level1">
<h1 class="hasAnchor">
<a href="#if-we-divide-byth-sides-by-pry-we-can-simplify-the-statement" class="anchor"></a>If we divide byth sides by Pr(Y), we can simplify the statement</h1>
</div>
<div id="fracprr--yprypry--fracpry--rpr-r-pry-1" class="section level1">
<h1 class="hasAnchor">
<a href="#fracprr--yprypry--fracpry--rpr-r-pry-1" class="anchor"></a>$\frac{(Pr(R | Y)Pr(Y))}{Pr(Y)}$ = $\frac{(Pr(Y | R)Pr( R ))}{Pr(Y)}$</h1>
</div>
<div id="simplifies-to" class="section level1">
<h1 class="hasAnchor">
<a href="#simplifies-to" class="anchor"></a>Simplifies to:</h1>
</div>
<div id="prry--fracpry--rpr-r-pry" class="section level1">
<h1 class="hasAnchor">
<a href="#prry--fracpry--rpr-r-pry" class="anchor"></a>Pr(R|Y) = $\frac{(Pr(Y | R)Pr( R ))}{Pr(Y)}$</h1>
</div>
<div id="bayes-rule-2" class="section level1">
<h1 class="hasAnchor">
<a href="#bayes-rule-2" class="anchor"></a>Bayes Rule</h1>
</div>
<div id="fracprr--yprypry--fracpry--rpr-r-pry-2" class="section level1">
<h1 class="hasAnchor">
<a href="#fracprr--yprypry--fracpry--rpr-r-pry-2" class="anchor"></a>$\frac{(Pr(R | Y)Pr(Y))}{Pr(Y)}$ = $\frac{(Pr(Y | R)Pr( R ))}{Pr(Y)}$</h1>
</div>
<div id="simplifies-to-1" class="section level1">
<h1 class="hasAnchor">
<a href="#simplifies-to-1" class="anchor"></a>Simplifies to:</h1>
</div>
<div id="prry--fracpry--rpr-r-pry-1" class="section level1">
<h1 class="hasAnchor">
<a href="#prry--fracpry--rpr-r-pry-1" class="anchor"></a><em>Pr(R|Y)</em> = $\frac{(Pr(Y | R)Pr( R ))}{Pr(Y)}$</h1>
</div>
<div id="posterior-probability-of-red-headedness" class="section level1">
<h1 class="hasAnchor">
<a href="#posterior-probability-of-red-headedness" class="anchor"></a>Posterior Probability of red-headedness</h1>
</div>
<div id="bayes-rule-3" class="section level1">
<h1 class="hasAnchor">
<a href="#bayes-rule-3" class="anchor"></a>Bayes Rule</h1>
</div>
<div id="fracprr--yprypry--fracpry--rpr-r-pry-3" class="section level1">
<h1 class="hasAnchor">
<a href="#fracprr--yprypry--fracpry--rpr-r-pry-3" class="anchor"></a>$\frac{(Pr(R | Y)Pr(Y))}{Pr(Y)}$ = $\frac{(Pr(Y | R)Pr( R ))}{Pr(Y)}$</h1>
<p>#Simplifies to:</p>
</div>
<div id="prry--fracpry--r-pr-r-pry" class="section level1">
<h1 class="hasAnchor">
<a href="#prry--fracpry--r-pr-r-pry" class="anchor"></a>Pr(R|Y) = $\frac{(Pr(Y | R) Pr( R ))}{Pr(Y)}$</h1>
</div>
<div id="likelihood-of-red-headed-given-yellow-breasted" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-of-red-headed-given-yellow-breasted" class="anchor"></a>Likelihood of Red-headed given Yellow-breasted</h1>
</div>
<div id="bayes-rule-4" class="section level1">
<h1 class="hasAnchor">
<a href="#bayes-rule-4" class="anchor"></a>Bayes Rule</h1>
</div>
<div id="fracprr--yprypry--fracpry--rpr-r-pry-4" class="section level1">
<h1 class="hasAnchor">
<a href="#fracprr--yprypry--fracpry--rpr-r-pry-4" class="anchor"></a>$\frac{(Pr(R | Y)Pr(Y))}{Pr(Y)}$ = $\frac{(Pr(Y | R)Pr( R ))}{Pr(Y)}$</h1>
</div>
<div id="simplifies-to-2" class="section level1">
<h1 class="hasAnchor">
<a href="#simplifies-to-2" class="anchor"></a>Simplifies to:</h1>
</div>
<div id="prry--fracpry--r-pr-r-pry-1" class="section level1">
<h1 class="hasAnchor">
<a href="#prry--fracpry--r-pr-r-pry-1" class="anchor"></a>Pr(R|Y) = $\frac{(Pr(Y | R) Pr( R ))}{Pr(Y)}$</h1>
</div>
<div id="marginal-likelihood-of-being-yellow-breasted" class="section level1">
<h1 class="hasAnchor">
<a href="#marginal-likelihood-of-being-yellow-breasted" class="anchor"></a>Marginal likelihood of being yellow-breasted</h1>
</div>
<div id="bayes-rule-5" class="section level1">
<h1 class="hasAnchor">
<a href="#bayes-rule-5" class="anchor"></a>Bayes Rule</h1>
</div>
<div id="fracprr--yprypry--fracpry--rpr-r-pry-5" class="section level1">
<h1 class="hasAnchor">
<a href="#fracprr--yprypry--fracpry--rpr-r-pry-5" class="anchor"></a>$\frac{(Pr(R | Y)Pr(Y))}{Pr(Y)}$ = $\frac{(Pr(Y | R)Pr( R ))}{Pr(Y)}$</h1>
</div>
<div id="simplifies-to-3" class="section level1">
<h1 class="hasAnchor">
<a href="#simplifies-to-3" class="anchor"></a>Simplifies to:</h1>
</div>
<div id="prry--fracpry--r-pr-r-pry-2" class="section level1">
<h1 class="hasAnchor">
<a href="#prry--fracpry--r-pr-r-pry-2" class="anchor"></a>Pr(R|Y) = $\frac{(Pr(Y | R) Pr( R ))}{Pr(Y)}$</h1>
</div>
<div id="prior-probability-of-red-headedness" class="section level1">
<h1 class="hasAnchor">
<a href="#prior-probability-of-red-headedness" class="anchor"></a>Prior probability of red-headedness</h1>
</div>
<div id="priors-2" class="section level1">
<h1 class="hasAnchor">
<a href="#priors-2" class="anchor"></a>Priors</h1>
<div id="priors-reflect-prior-knowledge-or-work-about-a-problem-1" class="section level2">
<h2 class="hasAnchor">
<a href="#priors-reflect-prior-knowledge-or-work-about-a-problem-1" class="anchor"></a>Priors reflect <em>prior</em> knowledge or work about a problem</h2>
</div>
</div>
<div id="a-prior-can-always-be-overcome-by-strong-evidence" class="section level1">
<h1 class="hasAnchor">
<a href="#a-prior-can-always-be-overcome-by-strong-evidence" class="anchor"></a>A prior can always be overcome by strong evidence</h1>
</div>
<div id="bayes-rule-6" class="section level1">
<h1 class="hasAnchor">
<a href="#bayes-rule-6" class="anchor"></a>Bayes Rule</h1>
</div>
<div id="in-practice" class="section level1">
<h1 class="hasAnchor">
<a href="#in-practice" class="anchor"></a>In practice</h1>
</div>
<div id="prmodel-hypothesis--data-" class="section level1">
<h1 class="hasAnchor">
<a href="#prmodel-hypothesis--data-" class="anchor"></a>Pr(Model Hypothesis | Data) =</h1>
</div>
<div id="fracprdata--model-hypothesis-pr-model-hypothesis-prdata" class="section level1">
<h1 class="hasAnchor">
<a href="#fracprdata--model-hypothesis-pr-model-hypothesis-prdata" class="anchor"></a>$\frac{(Pr(Data | Model Hypothesis) Pr( Model Hypothesis ))}{Pr(Data)}$</h1>
</div>
<div id="prdata-derived-via-heuristics" class="section level1">
<h1 class="hasAnchor">
<a href="#prdata-derived-via-heuristics" class="anchor"></a>Pr(Data) derived via heuristics</h1>
</div>
<div id="tree-searching-under-ml-and-bayesian-analyses" class="section level1">
<h1 class="hasAnchor">
<a href="#tree-searching-under-ml-and-bayesian-analyses" class="anchor"></a>Tree Searching Under ML and Bayesian Analyses</h1>
<p><img src="img/Ptree_enum.png" alt="Parsimony Trees"></p>
<div id="--weve-covered-that-it-is-not-practical-to-brute-force-search-trees" class="section level2">
<h2 class="hasAnchor">
<a href="#--weve-covered-that-it-is-not-practical-to-brute-force-search-trees" class="anchor"></a>- We’ve covered that it is not practical to brute-force search trees</h2>
</div>
<div id="--weve-covered-some-heuristics" class="section level2">
<h2 class="hasAnchor">
<a href="#--weve-covered-some-heuristics" class="anchor"></a>- We’ve covered some heuristics</h2>
</div>
<div id="--parsimony-heuristics-can-be-simple---we-are-simply-varying-the-topology" class="section level2">
<h2 class="hasAnchor">
<a href="#--parsimony-heuristics-can-be-simple---we-are-simply-varying-the-topology" class="anchor"></a>- Parsimony heuristics can be simple - we are simply varying the topology</h2>
</div>
<div id="--what-happens-when-we-need-to-vary-topology-branch-lengths-and-a-bunch-of-model-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#--what-happens-when-we-need-to-vary-topology-branch-lengths-and-a-bunch-of-model-parameters" class="anchor"></a>- What happens when we need to vary topology, branch lengths and a bunch of model parameters?</h2>
</div>
</div>
<div id="mcmc" class="section level1">
<h1 class="hasAnchor">
<a href="#mcmc" class="anchor"></a>MCMC</h1>
<div id="markov-chain-monte-carlo" class="section level2">
<h2 class="hasAnchor">
<a href="#markov-chain-monte-carlo" class="anchor"></a>Markov Chain Monte Carlo</h2>
</div>
<div id="--this-sounds-intimidating-but-lets-break-it-down-a-little-bit" class="section level2">
<h2 class="hasAnchor">
<a href="#--this-sounds-intimidating-but-lets-break-it-down-a-little-bit" class="anchor"></a>- This sounds intimidating, but let’s break it down a little bit</h2>
</div>
<div id="--markov-chain-memoryless-process" class="section level2">
<h2 class="hasAnchor">
<a href="#--markov-chain-memoryless-process" class="anchor"></a>- Markov chain: Memoryless process</h2>
</div>
<div id="--monte-carlo-random-proposals" class="section level2">
<h2 class="hasAnchor">
<a href="#--monte-carlo-random-proposals" class="anchor"></a>- Monte Carlo: Random proposals</h2>
</div>
</div>
<div id="mcmc-1" class="section level1">
<h1 class="hasAnchor">
<a href="#mcmc-1" class="anchor"></a>MCMC</h1>
<div id="markov-chain-monte-carlo-1" class="section level2">
<h2 class="hasAnchor">
<a href="#markov-chain-monte-carlo-1" class="anchor"></a>Markov Chain Monte Carlo</h2>
</div>
<div id="--this-sounds-intimidating-but-lets-break-it-down-a-little-bit-1" class="section level2">
<h2 class="hasAnchor">
<a href="#--this-sounds-intimidating-but-lets-break-it-down-a-little-bit-1" class="anchor"></a>- This sounds intimidating, but let’s break it down a little bit</h2>
</div>
<div id="--markov-chain-memoryless-process-1" class="section level2">
<h2 class="hasAnchor">
<a href="#--markov-chain-memoryless-process-1" class="anchor"></a>- Markov chain: Memoryless process</h2>
</div>
<div id="--monte-carlo-random-proposals-1" class="section level2">
<h2 class="hasAnchor">
<a href="#--monte-carlo-random-proposals-1" class="anchor"></a>- Monte Carlo: Random proposals</h2>
</div>
<div id="put-it-together-we-start-with-some-value-for-a-parameter-and-make-changes-to-it-stoachstically-then-we-evaluate-the-likelihood-score-of-that-new-parameter-if-it-is-good-we-keep-it-if-it-is-bad-we-chuck-it" class="section level2">
<h2 class="hasAnchor">
<a href="#put-it-together-we-start-with-some-value-for-a-parameter-and-make-changes-to-it-stoachstically-then-we-evaluate-the-likelihood-score-of-that-new-parameter-if-it-is-good-we-keep-it-if-it-is-bad-we-chuck-it" class="anchor"></a>Put it together: we start with some value for a parameter, and make changes to it stoachstically. Then, we evaluate the likelihood score of that new parameter. If it is good, we keep it. If it is bad, we chuck it.</h2>
</div>
</div>
<div id="mcmc-2" class="section level1">
<h1 class="hasAnchor">
<a href="#mcmc-2" class="anchor"></a>MCMC</h1>
<div id="put-it-together-we-start-with-some-value-for-a-parameter-and-make-changes-to-it-stoachstically-then-we-evaluate-the-likelihood-score-of-that-new-parameter-if-it-is-good-we-use-it-to-seed-future-searches-if-it-is-bad-we-keep-our-current-value" class="section level2">
<h2 class="hasAnchor">
<a href="#put-it-together-we-start-with-some-value-for-a-parameter-and-make-changes-to-it-stoachstically-then-we-evaluate-the-likelihood-score-of-that-new-parameter-if-it-is-good-we-use-it-to-seed-future-searches-if-it-is-bad-we-keep-our-current-value" class="anchor"></a>Put it together: we start with some value for a parameter, and make changes to it stoachstically. Then, we evaluate the likelihood score of that new parameter. If it is good, we use it to seed future searches. If it is bad, we keep our current value.</h2>
<ul>
<li>Where does the lack of memory come in? And why is that a good thing?</li>
</ul>
</div>
</div>
<div id="mcmc-3" class="section level1">
<h1 class="hasAnchor">
<a href="#mcmc-3" class="anchor"></a>MCMC</h1>
<pre class="rev"><code>for (i in 1:nbr){
    br_lens[i] ~ dnExponential(br_len_lambda)
    moves[mvi++] = mvScale(br_lens[i]) 
}</code></pre>
<p>Let’s think about this in plain language.</p>
<ul>
<li>Assign a length of each branch (drawn from a gamma)</li>
<li>Choose how the parameter will be changed (by scaling)</li>
</ul>
</div>
<div id="mcmc-4" class="section level1">
<h1 class="hasAnchor">
<a href="#mcmc-4" class="anchor"></a>MCMC</h1>
<pre class="rev"><code>for (i in 1:nbr){
    br_lens[i] ~ dnExponential(br_len_lambda)
    moves[mvi++] = mvScale(br_lens[i]) 
}</code></pre>
<p>Let’s think about this in plain language.</p>
<ul>
<li>Assign a length of each branch (drawn from a gamma)</li>
<li>Choose how the parameter will be changed (by scaling)</li>
<li>A solution that is good will be hit many times</li>
</ul>
</div>
<div id="mcmc-5" class="section level1">
<h1 class="hasAnchor">
<a href="#mcmc-5" class="anchor"></a>MCMC</h1>
<pre class="rev"><code>tau ~ dnUniformTopology(names)
moves[mvi++] = mvNNI(tau, weight=2*nbr)
phylogeny := treeAssembly(tau, br_lens)
moves[mvi++] = mvSPR(tau, weight=nbr)
</code></pre>
<p>Let’s think about this in plain language.</p>
<ul>
<li>Build an initial tree</li>
<li>Change it via SPR and NNI</li>
<li>What is the idea of weight?</li>
</ul>
</div>
<div id="mcmc-6" class="section level1">
<h1 class="hasAnchor">
<a href="#mcmc-6" class="anchor"></a>MCMC</h1>
<ul>
<li>Under ML: We use this to try to find a set of parameters that gives us the best model likelihood.</li>
<li>Under Bayesian: We use this to obtain a sample of models and parameters that show us the range of solutions for our data</li>
</ul>
</div>
<div id="bayes-rule-7" class="section level1">
<h1 class="hasAnchor">
<a href="#bayes-rule-7" class="anchor"></a>Bayes Rule</h1>
<p>Hands On: Rev basics</p>
<p>Hands On: RB_Discrete_morphology, using priors to relax Mk assumptions</p>
<p>Hands On: RB_Discrete_morphology, analyzing the output Priors =========================================================</p>
<div id="priors-reflect-prior-knowledge-or-work-about-a-problem-2" class="section level2">
<h2 class="hasAnchor">
<a href="#priors-reflect-prior-knowledge-or-work-about-a-problem-2" class="anchor"></a>Priors reflect <em>prior</em> knowledge or work about a problem</h2>
<p>We, for example, know that it is not incredibly likely to have super long branch lengths. Let’s look at that branch length prior again:</p>
<pre class="rev"><code>for (i in 1:nbr){
    br_lens[i] ~ dnExponential(br_len_lambda)
    moves[mvi++] = mvScale(br_lens[i]) 
}</code></pre>
</div>
</div>


  </div>

</div>


      <footer>
      <div class="copyright">
  <p>Developed by April Wright.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

